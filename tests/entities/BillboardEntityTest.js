var Vector3D = require("awayjs-core/lib/geom/Vector3D");
var AssetLibrary = require("awayjs-core/lib/library/AssetLibrary");
var URLRequest = require("awayjs-core/lib/net/URLRequest");
var LoaderEvent = require("awayjs-core/lib/events/LoaderEvent");
var RequestAnimationFrame = require("awayjs-core/lib/utils/RequestAnimationFrame");
var View = require("awayjs-display/lib/containers/View");
var HoverController = require("awayjs-display/lib/controllers/HoverController");
var CSSMaterialBase = require("awayjs-display/lib/materials/CSSMaterialBase");
var AlignmentMode = require("awayjs-display/lib/base/AlignmentMode");
var CSSDefaultRenderer = require("awayjs-display/lib/render/CSSDefaultRenderer");
var Billboard = require("awayjs-display/lib/entities/Billboard");
var BillboardEntityTest = (function () {
    function BillboardEntityTest() {
        var _this = this;
        this._time = 0;
        this._move = false;
        this._billboards = new Array();
        //load an image
        AssetLibrary.load(new URLRequest('assets/256x256.png'));
        //listen for a resource complete event
        AssetLibrary.addEventListener(LoaderEvent.RESOURCE_COMPLETE, function (event) { return _this.onResourceComplete(event); });
    }
    /**
     * Listener for resource complete event
     *
     * @param event
     */
    BillboardEntityTest.prototype.onResourceComplete = function (event) {
        var _this = this;
        //get the image texture
        this._imageTexture = event.assets[0];
        //create the view
        this._view = new View(new CSSDefaultRenderer());
        //create a bitmap material
        this._bitmapMaterial = new CSSMaterialBase(this._imageTexture);
        var billboard;
        var numBillboards = 500;
        for (var i = 0; i < numBillboards; i++) {
            billboard = new Billboard(this._bitmapMaterial);
            billboard.width = 50;
            billboard.height = 50;
            billboard.pivot = new Vector3D(25, 25, 0);
            billboard.x = Math.cos(i * 32 * Math.PI / numBillboards) * 400 * Math.sin(i * Math.PI / numBillboards);
            billboard.y = Math.sin(i * 32 * Math.PI / numBillboards) * 400 * Math.sin(i * Math.PI / numBillboards);
            billboard.z = Math.cos(i * Math.PI / numBillboards) * 400;
            //billboard.orientationMode = away.base.OrientationMode.CAMERA_PLANE;
            billboard.alignmentMode = AlignmentMode.PIVOT_POINT;
            this._billboards.push(billboard);
            //add billboard to the scene
            this._view.scene.addChild(billboard);
        }
        this._hoverControl = new HoverController(this._view.camera, null, 150, 10);
        document.onmousedown = function (event) { return _this.onMouseDownHandler(event); };
        document.onmouseup = function (event) { return _this.onMouseUpHandler(event); };
        document.onmousemove = function (event) { return _this.onMouseMove(event); };
        window.onresize = function (event) { return _this.onResize(event); };
        //trigger an initial resize for the view
        this.onResize(null);
        //setup the RAF for a render listener
        this._timer = new RequestAnimationFrame(this.render, this);
        this._timer.start();
    };
    BillboardEntityTest.prototype.onResize = function (event) {
        this._view.x = 0;
        this._view.y = 0;
        this._view.width = window.innerWidth;
        this._view.height = window.innerHeight;
    };
    BillboardEntityTest.prototype.render = function (dt) {
        this._time += dt;
        for (var i = 0; i < this._billboards.length; i++) {
            this._billboards[i].rotationZ = i + this._time / 10;
            this._billboards[i].rotationX = i + this._time / 10;
        }
        this._view.render();
    };
    BillboardEntityTest.prototype.onMouseUpHandler = function (event) {
        this._move = false;
    };
    BillboardEntityTest.prototype.onMouseMove = function (event) {
        if (this._move) {
            this._hoverControl.panAngle = 0.3 * (event.clientX - this._lastMouseX) + this._lastPanAngle;
            this._hoverControl.tiltAngle = 0.3 * (event.clientY - this._lastMouseY) + this._lastTiltAngle;
        }
    };
    BillboardEntityTest.prototype.onMouseDownHandler = function (event) {
        this._lastPanAngle = this._hoverControl.panAngle;
        this._lastTiltAngle = this._hoverControl.tiltAngle;
        this._lastMouseX = event.clientX;
        this._lastMouseY = event.clientY;
        this._move = true;
    };
    return BillboardEntityTest;
})();

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImVudGl0aWVzL2JpbGxib2FyZGVudGl0eXRlc3QudHMiXSwibmFtZXMiOlsiQmlsbGJvYXJkRW50aXR5VGVzdCIsIkJpbGxib2FyZEVudGl0eVRlc3QuY29uc3RydWN0b3IiLCJCaWxsYm9hcmRFbnRpdHlUZXN0Lm9uUmVzb3VyY2VDb21wbGV0ZSIsIkJpbGxib2FyZEVudGl0eVRlc3Qub25SZXNpemUiLCJCaWxsYm9hcmRFbnRpdHlUZXN0LnJlbmRlciIsIkJpbGxib2FyZEVudGl0eVRlc3Qub25Nb3VzZVVwSGFuZGxlciIsIkJpbGxib2FyZEVudGl0eVRlc3Qub25Nb3VzZU1vdmUiLCJCaWxsYm9hcmRFbnRpdHlUZXN0Lm9uTW91c2VEb3duSGFuZGxlciJdLCJtYXBwaW5ncyI6IkFBQUEsSUFBTyxRQUFRLFdBQWUsK0JBQStCLENBQUMsQ0FBQztBQUMvRCxJQUFPLFlBQVksV0FBYyxzQ0FBc0MsQ0FBQyxDQUFDO0FBRXpFLElBQU8sVUFBVSxXQUFjLGdDQUFnQyxDQUFDLENBQUM7QUFDakUsSUFBTyxXQUFXLFdBQWMsb0NBQW9DLENBQUMsQ0FBQztBQUV0RSxJQUFPLHFCQUFxQixXQUFXLDZDQUE2QyxDQUFDLENBQUM7QUFFdEYsSUFBTyxJQUFJLFdBQWdCLG9DQUFvQyxDQUFDLENBQUM7QUFDakUsSUFBTyxlQUFlLFdBQWEsZ0RBQWdELENBQUMsQ0FBQztBQUNyRixJQUFPLGVBQWUsV0FBYSw4Q0FBOEMsQ0FBQyxDQUFDO0FBQ25GLElBQU8sYUFBYSxXQUFhLHVDQUF1QyxDQUFDLENBQUM7QUFDMUUsSUFBTyxrQkFBa0IsV0FBWSw4Q0FBOEMsQ0FBQyxDQUFDO0FBQ3JGLElBQU8sU0FBUyxXQUFjLHVDQUF1QyxDQUFDLENBQUM7QUFHdkUsSUFBTSxtQkFBbUI7SUFpQnhCQSxTQWpCS0EsbUJBQW1CQTtRQUF6QkMsaUJBb0hDQTtRQWhIUUEsVUFBS0EsR0FBVUEsQ0FBQ0EsQ0FBQ0E7UUFHakJBLFVBQUtBLEdBQVdBLEtBQUtBLENBQUNBO1FBUXRCQSxn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VUFBb0JBLEtBQWdCQTtRQUVuQ00sRUFBRUEsQ0FBQ0EsQ0FBQ0EsSUFBSUEsQ0FBQ0EsS0FBS0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0E7WUFDaEJBLElBQUlBLENBQUNBLGFBQWFBLENBQUNBLFFBQVFBLEdBQUdBLEdBQUdBLEdBQUNBLENBQUNBLEtBQUtBLENBQUNBLE9BQU9BLEdBQUdBLElBQUlBLENBQUNBLFdBQVdBLENBQUNBLEdBQUdBLElBQUlBLENBQUNBLGFBQWFBLENBQUNBO1lBQzFGQSxJQUFJQSxDQUFDQSxhQUFhQSxDQUFDQSxTQUFTQSxHQUFHQSxHQUFHQSxHQUFDQSxDQUFDQSxLQUFLQSxDQUFDQSxPQUFPQSxHQUFHQSxJQUFJQSxDQUFDQSxXQUFXQSxDQUFDQSxHQUFHQSxJQUFJQSxDQUFDQSxjQUFjQSxDQUFDQTtRQUM3RkEsQ0FBQ0E7SUFDRkEsQ0FBQ0E7SUFFT04sZ0RBQWtCQSxHQUExQkEsVUFBMkJBLEtBQWdCQTtRQUUxQ08sSUFBSUEsQ0FBQ0EsYUFBYUEsR0FBR0EsSUFBSUEsQ0FBQ0EsYUFBYUEsQ0FBQ0EsUUFBUUEsQ0FBQ0E7UUFDakRBLElBQUlBLENBQUNBLGNBQWNBLEdBQUdBLElBQUlBLENBQUNBLGFBQWFBLENBQUNBLFNBQVNBLENBQUNBO1FBQ25EQSxJQUFJQSxDQUFDQSxXQUFXQSxHQUFHQSxLQUFLQSxDQUFDQSxPQUFPQSxDQUFDQTtRQUNqQ0EsSUFBSUEsQ0FBQ0EsV0FBV0EsR0FBR0EsS0FBS0EsQ0FBQ0EsT0FBT0EsQ0FBQ0E7UUFDakNBLElBQUlBLENBQUNBLEtBQUtBLEdBQUdBLElBQUlBLENBQUNBO0lBQ25CQSxDQUFDQTtJQUNGUCwwQkFBQ0E7QUFBREEsQ0FwSEEsQUFvSENBLElBQUEiLCJmaWxlIjoiZW50aXRpZXMvQmlsbGJvYXJkRW50aXR5VGVzdC5qcyIsInNvdXJjZVJvb3QiOiIuL3Rlc3RzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IFZlY3RvcjNEXHRcdFx0XHRcdD0gcmVxdWlyZShcImF3YXlqcy1jb3JlL2xpYi9nZW9tL1ZlY3RvcjNEXCIpO1xuaW1wb3J0IEFzc2V0TGlicmFyeVx0XHRcdFx0PSByZXF1aXJlKFwiYXdheWpzLWNvcmUvbGliL2xpYnJhcnkvQXNzZXRMaWJyYXJ5XCIpO1xuaW1wb3J0IFVSTExvYWRlclx0XHRcdFx0PSByZXF1aXJlKFwiYXdheWpzLWNvcmUvbGliL25ldC9VUkxMb2FkZXJcIik7XG5pbXBvcnQgVVJMUmVxdWVzdFx0XHRcdFx0PSByZXF1aXJlKFwiYXdheWpzLWNvcmUvbGliL25ldC9VUkxSZXF1ZXN0XCIpO1xuaW1wb3J0IExvYWRlckV2ZW50XHRcdFx0XHQ9IHJlcXVpcmUoXCJhd2F5anMtY29yZS9saWIvZXZlbnRzL0xvYWRlckV2ZW50XCIpO1xuaW1wb3J0IEltYWdlVGV4dHVyZVx0XHRcdFx0PSByZXF1aXJlKFwiYXdheWpzLWNvcmUvbGliL3RleHR1cmVzL0ltYWdlVGV4dHVyZVwiKTtcbmltcG9ydCBSZXF1ZXN0QW5pbWF0aW9uRnJhbWVcdD0gcmVxdWlyZShcImF3YXlqcy1jb3JlL2xpYi91dGlscy9SZXF1ZXN0QW5pbWF0aW9uRnJhbWVcIik7XG5cbmltcG9ydCBWaWV3XHRcdFx0XHRcdFx0PSByZXF1aXJlKFwiYXdheWpzLWRpc3BsYXkvbGliL2NvbnRhaW5lcnMvVmlld1wiKTtcbmltcG9ydCBIb3ZlckNvbnRyb2xsZXJcdFx0XHQ9IHJlcXVpcmUoXCJhd2F5anMtZGlzcGxheS9saWIvY29udHJvbGxlcnMvSG92ZXJDb250cm9sbGVyXCIpO1xuaW1wb3J0IENTU01hdGVyaWFsQmFzZVx0XHRcdD0gcmVxdWlyZShcImF3YXlqcy1kaXNwbGF5L2xpYi9tYXRlcmlhbHMvQ1NTTWF0ZXJpYWxCYXNlXCIpO1xuaW1wb3J0IEFsaWdubWVudE1vZGVcdFx0XHQ9IHJlcXVpcmUoXCJhd2F5anMtZGlzcGxheS9saWIvYmFzZS9BbGlnbm1lbnRNb2RlXCIpO1xuaW1wb3J0IENTU0RlZmF1bHRSZW5kZXJlclx0XHQ9IHJlcXVpcmUoXCJhd2F5anMtZGlzcGxheS9saWIvcmVuZGVyL0NTU0RlZmF1bHRSZW5kZXJlclwiKTtcbmltcG9ydCBCaWxsYm9hcmRcdFx0XHRcdD0gcmVxdWlyZShcImF3YXlqcy1kaXNwbGF5L2xpYi9lbnRpdGllcy9CaWxsYm9hcmRcIik7XG5cblxuY2xhc3MgQmlsbGJvYXJkRW50aXR5VGVzdFxue1xuXHRwcml2YXRlIF92aWV3OlZpZXc7XG5cdHByaXZhdGUgX3RpbWVyOlJlcXVlc3RBbmltYXRpb25GcmFtZTtcblx0cHJpdmF0ZSBfdGltZTpudW1iZXIgPSAwO1xuXHRwcml2YXRlIF9ob3ZlckNvbnRyb2w6SG92ZXJDb250cm9sbGVyO1xuXG5cdHByaXZhdGUgX21vdmU6Ym9vbGVhbiA9IGZhbHNlO1xuXHRwcml2YXRlIF9sYXN0UGFuQW5nbGU6bnVtYmVyO1xuXHRwcml2YXRlIF9sYXN0VGlsdEFuZ2xlOm51bWJlcjtcblx0cHJpdmF0ZSBfbGFzdE1vdXNlWDpudW1iZXI7XG5cdHByaXZhdGUgX2xhc3RNb3VzZVk6bnVtYmVyO1xuXG5cdHByaXZhdGUgX2ltYWdlVGV4dHVyZTpJbWFnZVRleHR1cmU7XG5cdHByaXZhdGUgX2JpdG1hcE1hdGVyaWFsOkNTU01hdGVyaWFsQmFzZTtcblx0cHJpdmF0ZSBfYmlsbGJvYXJkczpBcnJheTxCaWxsYm9hcmQ+ID0gbmV3IEFycmF5PEJpbGxib2FyZD4oKTtcblxuXHRjb25zdHJ1Y3RvcigpXG5cdHtcblx0XHQvL2xvYWQgYW4gaW1hZ2Vcblx0XHRBc3NldExpYnJhcnkubG9hZChuZXcgVVJMUmVxdWVzdCgnYXNzZXRzLzI1NngyNTYucG5nJykpO1xuXG5cdFx0Ly9saXN0ZW4gZm9yIGEgcmVzb3VyY2UgY29tcGxldGUgZXZlbnRcblx0XHRBc3NldExpYnJhcnkuYWRkRXZlbnRMaXN0ZW5lcihMb2FkZXJFdmVudC5SRVNPVVJDRV9DT01QTEVURSwgKGV2ZW50OkxvYWRlckV2ZW50KSA9PiB0aGlzLm9uUmVzb3VyY2VDb21wbGV0ZShldmVudCkpO1xuXHR9XG5cblx0LyoqXG5cdCAqIExpc3RlbmVyIGZvciByZXNvdXJjZSBjb21wbGV0ZSBldmVudFxuXHQgKlxuXHQgKiBAcGFyYW0gZXZlbnRcblx0ICovXG5cdG9uUmVzb3VyY2VDb21wbGV0ZShldmVudDpMb2FkZXJFdmVudClcblx0e1xuXHRcdC8vZ2V0IHRoZSBpbWFnZSB0ZXh0dXJlXG5cdFx0dGhpcy5faW1hZ2VUZXh0dXJlID0gPEltYWdlVGV4dHVyZT4gZXZlbnQuYXNzZXRzWzBdO1xuXG5cdFx0Ly9jcmVhdGUgdGhlIHZpZXdcblx0XHR0aGlzLl92aWV3ID0gbmV3IFZpZXcobmV3IENTU0RlZmF1bHRSZW5kZXJlcigpKTtcblxuXHRcdC8vY3JlYXRlIGEgYml0bWFwIG1hdGVyaWFsXG5cdFx0dGhpcy5fYml0bWFwTWF0ZXJpYWwgPSBuZXcgQ1NTTWF0ZXJpYWxCYXNlKHRoaXMuX2ltYWdlVGV4dHVyZSk7XG5cblx0XHR2YXIgYmlsbGJvYXJkOkJpbGxib2FyZDtcblx0XHR2YXIgbnVtQmlsbGJvYXJkczpudW1iZXIgPSA1MDA7XG5cdFx0Zm9yICh2YXIgaTpudW1iZXIgPSAwOyBpIDwgbnVtQmlsbGJvYXJkczsgaSsrKSB7XG5cdFx0XHRiaWxsYm9hcmQgPSBuZXcgQmlsbGJvYXJkKHRoaXMuX2JpdG1hcE1hdGVyaWFsKTtcblx0XHRcdGJpbGxib2FyZC53aWR0aCA9IDUwO1xuXHRcdFx0YmlsbGJvYXJkLmhlaWdodCA9IDUwO1xuXHRcdFx0YmlsbGJvYXJkLnBpdm90ID0gbmV3IFZlY3RvcjNEKDI1LCAyNSwgMCk7XG5cdFx0XHRiaWxsYm9hcmQueCA9IE1hdGguY29zKGkqMzIqTWF0aC5QSS9udW1CaWxsYm9hcmRzKSo0MDAqTWF0aC5zaW4oaSpNYXRoLlBJL251bUJpbGxib2FyZHMpO1xuXHRcdFx0YmlsbGJvYXJkLnkgPSBNYXRoLnNpbihpKjMyKk1hdGguUEkvbnVtQmlsbGJvYXJkcykqNDAwKk1hdGguc2luKGkqTWF0aC5QSS9udW1CaWxsYm9hcmRzKTtcblx0XHRcdGJpbGxib2FyZC56ID0gTWF0aC5jb3MoaSpNYXRoLlBJL251bUJpbGxib2FyZHMpKjQwMDtcblx0XHRcdC8vYmlsbGJvYXJkLm9yaWVudGF0aW9uTW9kZSA9IGF3YXkuYmFzZS5PcmllbnRhdGlvbk1vZGUuQ0FNRVJBX1BMQU5FO1xuXHRcdFx0YmlsbGJvYXJkLmFsaWdubWVudE1vZGUgPSBBbGlnbm1lbnRNb2RlLlBJVk9UX1BPSU5UO1xuXHRcdFx0dGhpcy5fYmlsbGJvYXJkcy5wdXNoKGJpbGxib2FyZCk7XG5cdFx0XHQvL2FkZCBiaWxsYm9hcmQgdG8gdGhlIHNjZW5lXG5cdFx0XHR0aGlzLl92aWV3LnNjZW5lLmFkZENoaWxkKGJpbGxib2FyZCk7XG5cdFx0fVxuXG5cdFx0dGhpcy5faG92ZXJDb250cm9sID0gbmV3IEhvdmVyQ29udHJvbGxlcih0aGlzLl92aWV3LmNhbWVyYSwgbnVsbCwgMTUwLCAxMCk7XG5cblx0XHRkb2N1bWVudC5vbm1vdXNlZG93biA9IChldmVudDpNb3VzZUV2ZW50KSA9PiB0aGlzLm9uTW91c2VEb3duSGFuZGxlcihldmVudCk7XG5cdFx0ZG9jdW1lbnQub25tb3VzZXVwID0gKGV2ZW50Ok1vdXNlRXZlbnQpID0+IHRoaXMub25Nb3VzZVVwSGFuZGxlcihldmVudCk7XG5cdFx0ZG9jdW1lbnQub25tb3VzZW1vdmUgPSAoZXZlbnQ6TW91c2VFdmVudCkgPT4gdGhpcy5vbk1vdXNlTW92ZShldmVudCk7XG5cblx0XHR3aW5kb3cub25yZXNpemUgID0gKGV2ZW50OlVJRXZlbnQpID0+IHRoaXMub25SZXNpemUoZXZlbnQpO1xuXG5cdFx0Ly90cmlnZ2VyIGFuIGluaXRpYWwgcmVzaXplIGZvciB0aGUgdmlld1xuXHRcdHRoaXMub25SZXNpemUobnVsbCk7XG5cblx0XHQvL3NldHVwIHRoZSBSQUYgZm9yIGEgcmVuZGVyIGxpc3RlbmVyXG5cdFx0dGhpcy5fdGltZXIgPSBuZXcgUmVxdWVzdEFuaW1hdGlvbkZyYW1lKHRoaXMucmVuZGVyLCB0aGlzKTtcblx0XHR0aGlzLl90aW1lci5zdGFydCgpO1xuXHR9XG5cblx0cHJpdmF0ZSBvblJlc2l6ZShldmVudDpVSUV2ZW50KVxuXHR7XG5cdFx0dGhpcy5fdmlldy54ID0gMDtcblx0XHR0aGlzLl92aWV3LnkgPSAwO1xuXHRcdHRoaXMuX3ZpZXcud2lkdGggPSB3aW5kb3cuaW5uZXJXaWR0aDtcblx0XHR0aGlzLl92aWV3LmhlaWdodCA9IHdpbmRvdy5pbm5lckhlaWdodDtcblx0fVxuXG5cdHByaXZhdGUgcmVuZGVyKGR0Om51bWJlcilcblx0e1xuXHRcdHRoaXMuX3RpbWUgKz0gZHQ7XG5cdFx0Zm9yICh2YXIgaTpudW1iZXIgPSAwOyBpIDwgdGhpcy5fYmlsbGJvYXJkcy5sZW5ndGg7IGkrKykge1xuXHRcdFx0dGhpcy5fYmlsbGJvYXJkc1tpXS5yb3RhdGlvblogPSBpICsgdGhpcy5fdGltZS8xMDtcblx0XHRcdHRoaXMuX2JpbGxib2FyZHNbaV0ucm90YXRpb25YID0gaSArIHRoaXMuX3RpbWUvMTA7XG5cdFx0fVxuXG5cdFx0dGhpcy5fdmlldy5yZW5kZXIoKTtcblxuXHR9XG5cblx0cHJpdmF0ZSBvbk1vdXNlVXBIYW5kbGVyKGV2ZW50Ok1vdXNlRXZlbnQpXG5cdHtcblx0XHR0aGlzLl9tb3ZlID0gZmFsc2U7XG5cdH1cblxuXHRwcml2YXRlIG9uTW91c2VNb3ZlKGV2ZW50Ok1vdXNlRXZlbnQpXG5cdHtcblx0XHRpZiAodGhpcy5fbW92ZSkge1xuXHRcdFx0dGhpcy5faG92ZXJDb250cm9sLnBhbkFuZ2xlID0gMC4zKihldmVudC5jbGllbnRYIC0gdGhpcy5fbGFzdE1vdXNlWCkgKyB0aGlzLl9sYXN0UGFuQW5nbGU7XG5cdFx0XHR0aGlzLl9ob3ZlckNvbnRyb2wudGlsdEFuZ2xlID0gMC4zKihldmVudC5jbGllbnRZIC0gdGhpcy5fbGFzdE1vdXNlWSkgKyB0aGlzLl9sYXN0VGlsdEFuZ2xlO1xuXHRcdH1cblx0fVxuXG5cdHByaXZhdGUgb25Nb3VzZURvd25IYW5kbGVyKGV2ZW50Ok1vdXNlRXZlbnQpXG5cdHtcblx0XHR0aGlzLl9sYXN0UGFuQW5nbGUgPSB0aGlzLl9ob3ZlckNvbnRyb2wucGFuQW5nbGU7XG5cdFx0dGhpcy5fbGFzdFRpbHRBbmdsZSA9IHRoaXMuX2hvdmVyQ29udHJvbC50aWx0QW5nbGU7XG5cdFx0dGhpcy5fbGFzdE1vdXNlWCA9IGV2ZW50LmNsaWVudFg7XG5cdFx0dGhpcy5fbGFzdE1vdXNlWSA9IGV2ZW50LmNsaWVudFk7XG5cdFx0dGhpcy5fbW92ZSA9IHRydWU7XG5cdH1cbn0iXX0=