var __extends = this.__extends || function (d, b) {
    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];
    function __() { this.constructor = d; }
    __.prototype = b.prototype;
    d.prototype = new __();
};
var EventDispatcher = require("awayjs-core/lib/events/EventDispatcher");
var DisplayObjectContainer = require("awayjs-display/lib/containers/DisplayObjectContainer");
var SceneEvent = require("awayjs-display/lib/events/SceneEvent");
var NodeBase = require("awayjs-display/lib/partition/NodeBase");
var Partition = require("awayjs-display/lib/partition/Partition");
var Scene = (function (_super) {
    __extends(Scene, _super);
    function Scene() {
        _super.call(this);
        this._expandedPartitions = new Array();
        this._partitions = new Array();
        this._iCollectionMark = 0;
        this._iSceneGraphRoot = new DisplayObjectContainer();
        this._iSceneGraphRoot._iSetScene(this);
        this._iSceneGraphRoot._iIsRoot = true;
        this._iSceneGraphRoot.partition = new Partition(new NodeBase());
    }
    Scene.prototype.traversePartitions = function (traverser) {
        var i = 0;
        var len = this._partitions.length;
        traverser.scene = this;
        while (i < len) {
            this._iCollectionMark++;
            this._partitions[i++].traverse(traverser);
        }
    };
    Object.defineProperty(Scene.prototype, "partition", {
        get: function () {
            return this._iSceneGraphRoot.partition;
        },
        set: function (value) {
            this._iSceneGraphRoot.partition = value;
            this.dispatchEvent(new SceneEvent(SceneEvent.PARTITION_CHANGED, this._iSceneGraphRoot));
        },
        enumerable: true,
        configurable: true
    });
    Scene.prototype.contains = function (child) {
        return this._iSceneGraphRoot.contains(child);
    };
    Scene.prototype.addChild = function (child) {
        return this._iSceneGraphRoot.addChild(child);
    };
    Scene.prototype.removeChild = function (child) {
        this._iSceneGraphRoot.removeChild(child);
    };
    Scene.prototype.removeChildAt = function (index) {
        this._iSceneGraphRoot.removeChildAt(index);
    };
    Scene.prototype.getChildAt = function (index) {
        return this._iSceneGraphRoot.getChildAt(index);
    };
    Object.defineProperty(Scene.prototype, "numChildren", {
        get: function () {
            return this._iSceneGraphRoot.numChildren;
        },
        enumerable: true,
        configurable: true
    });
    /**
     * @internal
     */
    Scene.prototype.iRegisterEntity = function (displayObject) {
        if (displayObject.partition)
            this.iRegisterPartition(displayObject.partition);
        if (displayObject.isEntity)
            displayObject._iAssignedPartition.iMarkForUpdate(displayObject);
    };
    /**
     * @internal
     */
    Scene.prototype.iRegisterPartition = function (partition) {
        this._expandedPartitions.push(partition);
        //ensure duplicates are not found in partitions array
        if (this._partitions.indexOf(partition) == -1)
            this._partitions.push(partition);
    };
    /**
     * @internal
     */
    Scene.prototype.iUnregisterEntity = function (displayObject) {
        if (displayObject.partition)
            this.iUnregisterPartition(displayObject.partition);
        if (displayObject.isEntity)
            displayObject._iAssignedPartition.iRemoveEntity(displayObject);
    };
    /**
     * @internal
     */
    Scene.prototype.iUnregisterPartition = function (partition) {
        this._expandedPartitions.splice(this._expandedPartitions.indexOf(partition), 1);
        //if no more partition references found, remove from partitions array
        if (this._expandedPartitions.indexOf(partition) == -1)
            this._partitions.splice(this._partitions.indexOf(partition), 1);
    };
    return Scene;
})(EventDispatcher);
module.exports = Scene;

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImF3YXlqcy1kaXNwbGF5L2xpYi9jb250YWluZXJzL1NjZW5lLnRzIl0sIm5hbWVzIjpbIlNjZW5lIiwiU2NlbmUuY29uc3RydWN0b3IiLCJTY2VuZS50cmF2ZXJzZVBhcnRpdGlvbnMiLCJTY2VuZS5wYXJ0aXRpb24iLCJTY2VuZS5jb250YWlucyIsIlNjZW5lLmFkZENoaWxkIiwiU2NlbmUucmVtb3ZlQ2hpbGQiLCJTY2VuZS5yZW1vdmVDaGlsZEF0IiwiU2NlbmUuZ2V0Q2hpbGRBdCIsIlNjZW5lLm51bUNoaWxkcmVuIiwiU2NlbmUuaVJlZ2lzdGVyRW50aXR5IiwiU2NlbmUuaVJlZ2lzdGVyUGFydGl0aW9uIiwiU2NlbmUuaVVucmVnaXN0ZXJFbnRpdHkiLCJTY2VuZS5pVW5yZWdpc3RlclBhcnRpdGlvbiJdLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQUEsSUFBTyxlQUFlLFdBQWMsd0NBQXdDLENBQUMsQ0FBQztBQUc5RSxJQUFPLHNCQUFzQixXQUFZLHNEQUFzRCxDQUFDLENBQUM7QUFDakcsSUFBTyxVQUFVLFdBQWUsc0NBQXNDLENBQUMsQ0FBQztBQUN4RSxJQUFPLFFBQVEsV0FBZ0IsdUNBQXVDLENBQUMsQ0FBQztBQUN4RSxJQUFPLFNBQVMsV0FBZSx3Q0FBd0MsQ0FBQyxDQUFDO0FBR3pFLElBQU0sS0FBSztJQUFTQSxVQUFkQSxLQUFLQSxVQUF3QkE7SUFRbENBLFNBUktBLEtBQUtBO1FBVVRDLGlCQUFPQSxDQUFDQTtRQVJEQSx3QkFBbUJBLEdBQW9CQSxJQUFJQSxLQUFLQSxFQUFhQSxDQUFDQTtRQUM5REEsZ0JBQVdBLEdBQW9CQSxJQUFJQSxLQUFLQSxFQUFhQSxDQUFDQTtRQUd2REEscUJBQWdCQSxHQUFHQSxDQUFDQSxDQUFDQTtRQU0zQkEsSUFBSUEsQ0FBQ0EsZ0JBQWdCQSxHQUFHQSxJQUFJQSxzQkFBc0JBLEVBQUVBLENBQUNBO1FBRXJEQSxJQUFJQSxDQUFDQSxnQkFBZ0JBLENBQUNBLFVBQVVBLENBQUNBLElBQUlBLENBQUNBLENB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QUFDQSxXQUFXQSxDQUFDQSxNQUFNQSxDQUFDQSxJQUFJQSxDQUFDQSxXQUFXQSxDQUFDQSxPQUFPQSxDQUFDQSxTQUFTQSxDQUFDQSxFQUFFQSxDQUFDQSxDQUFDQSxDQUFDQTtJQUNsRUEsQ0FBQ0E7SUFDRmIsWUFBQ0E7QUFBREEsQ0ExSEEsQUEwSENBLEVBMUhtQixlQUFlLEVBMEhsQztBQUVELEFBQWUsaUJBQU4sS0FBSyxDQUFDIiwiZmlsZSI6ImNvbnRhaW5lcnMvU2NlbmUuanMiLCJzb3VyY2VSb290IjoiLi4vIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IEV2ZW50RGlzcGF0Y2hlclx0XHRcdFx0PSByZXF1aXJlKFwiYXdheWpzLWNvcmUvbGliL2V2ZW50cy9FdmVudERpc3BhdGNoZXJcIik7XHJcblxyXG5pbXBvcnQgRGlzcGxheU9iamVjdFx0XHRcdFx0PSByZXF1aXJlKFwiYXdheWpzLWRpc3BsYXkvbGliL2Jhc2UvRGlzcGxheU9iamVjdFwiKTtcclxuaW1wb3J0IERpc3BsYXlPYmplY3RDb250YWluZXJcdFx0PSByZXF1aXJlKFwiYXdheWpzLWRpc3BsYXkvbGliL2NvbnRhaW5lcnMvRGlzcGxheU9iamVjdENvbnRhaW5lclwiKTtcclxuaW1wb3J0IFNjZW5lRXZlbnRcdFx0XHRcdFx0PSByZXF1aXJlKFwiYXdheWpzLWRpc3BsYXkvbGliL2V2ZW50cy9TY2VuZUV2ZW50XCIpO1xyXG5pbXBvcnQgTm9kZUJhc2VcdFx0XHRcdFx0XHQ9IHJlcXVpcmUoXCJhd2F5anMtZGlzcGxheS9saWIvcGFydGl0aW9uL05vZGVCYXNlXCIpO1xyXG5pbXBvcnQgUGFydGl0aW9uXHRcdFx0XHRcdD0gcmVxdWlyZShcImF3YXlqcy1kaXNwbGF5L2xpYi9wYXJ0aXRpb24vUGFydGl0aW9uXCIpO1xyXG5pbXBvcnQgSUNvbGxlY3Rvclx0XHRcdFx0XHQ9IHJlcXVpcmUoXCJhd2F5anMtZGlzcGxheS9saWIvdHJhdmVyc2UvSUNvbGxlY3RvclwiKTtcclxuXHJcbmNsYXNzIFNjZW5lIGV4dGVuZHMgRXZlbnREaXNwYXRjaGVyXHJcbntcclxuXHRwcml2YXRlIF9leHBhbmRlZFBhcnRpdGlvbnM6QXJyYXk8UGFydGl0aW9uPiA9IG5ldyBBcnJheTxQYXJ0aXRpb24+KCk7XHJcblx0cHJpdmF0ZSBfcGFydGl0aW9uczpBcnJheTxQYXJ0aXRpb24+ID0gbmV3IEFycmF5PFBhcnRpdGlvbj4oKTtcclxuXHJcblx0cHVibGljIF9pU2NlbmVHcmFwaFJvb3Q6RGlzcGxheU9iamVjdENvbnRhaW5lcjtcclxuXHRwdWJsaWMgX2lDb2xsZWN0aW9uTWFyayA9IDA7XHJcblxyXG5cdGNvbnN0cnVjdG9yKClcclxuXHR7XHJcblx0XHRzdXBlcigpO1xyXG5cclxuXHRcdHRoaXMuX2lTY2VuZUdyYXBoUm9vdCA9IG5ldyBEaXNwbGF5T2JqZWN0Q29udGFpbmVyKCk7XHJcblxyXG5cdFx0dGhpcy5faVNjZW5lR3JhcGhSb290Ll9pU2V0U2NlbmUodGhpcyk7XHJcblx0XHR0aGlzLl9pU2NlbmVHcmFwaFJvb3QuX2lJc1Jvb3QgPSB0cnVlO1xyXG5cdFx0dGhpcy5faVNjZW5lR3JhcGhSb290LnBhcnRpdGlvbiA9IG5ldyBQYXJ0aXRpb24obmV3IE5vZGVCYXNlKCkpO1xyXG5cdH1cclxuXHJcblx0cHVibGljIHRyYXZlcnNlUGFydGl0aW9ucyh0cmF2ZXJzZXI6SUNvbGxlY3RvcilcclxuXHR7XHJcblx0XHR2YXIgaTpudW1iZXIgPSAwO1xyXG5cdFx0dmFyIGxlbjpudW1iZXIgPSB0aGlzLl9wYXJ0aXRpb25zLmxlbmd0aDtcclxuXHJcblx0XHR0cmF2ZXJzZXIuc2NlbmUgPSB0aGlzO1xyXG5cclxuXHRcdHdoaWxlIChpIDwgbGVuKSB7XHJcblx0XHRcdHRoaXMuX2lDb2xsZWN0aW9uTWFyaysrO1xyXG5cdFx0XHR0aGlzLl9wYXJ0aXRpb25zW2krK10udHJhdmVyc2UodHJhdmVyc2VyKTtcclxuXHRcdH1cclxuXHR9XHJcblxyXG5cdHB1YmxpYyBnZXQgcGFydGl0aW9uKCk6UGFydGl0aW9uXHJcblx0e1xyXG5cdFx0cmV0dXJuIHRoaXMuX2lTY2VuZUdyYXBoUm9vdC5wYXJ0aXRpb247XHJcblx0fVxyXG5cclxuXHRwdWJsaWMgc2V0IHBhcnRpdGlvbih2YWx1ZTpQYXJ0aXRpb24pXHJcblx0e1xyXG5cdFx0dGhpcy5faVNjZW5lR3JhcGhSb290LnBhcnRpdGlvbiA9IHZhbHVlO1xyXG5cclxuXHRcdHRoaXMuZGlzcGF0Y2hFdmVudChuZXcgU2NlbmVFdmVudChTY2VuZUV2ZW50LlBBUlRJVElPTl9DSEFOR0VELCB0aGlzLl9pU2NlbmVHcmFwaFJvb3QpKTtcclxuXHR9XHJcblxyXG5cdHB1YmxpYyBjb250YWlucyhjaGlsZDpEaXNwbGF5T2JqZWN0KTpib29sZWFuXHJcblx0e1xyXG5cdFx0cmV0dXJuIHRoaXMuX2lTY2VuZUdyYXBoUm9vdC5jb250YWlucyhjaGlsZCk7XHJcblx0fVxyXG5cclxuXHRwdWJsaWMgYWRkQ2hpbGQoY2hpbGQ6RGlzcGxheU9iamVjdCk6RGlzcGxheU9iamVjdFxyXG5cdHtcclxuXHRcdHJldHVybiB0aGlzLl9pU2NlbmVHcmFwaFJvb3QuYWRkQ2hpbGQoY2hpbGQpO1xyXG5cdH1cclxuXHJcblx0cHVibGljIHJlbW92ZUNoaWxkKGNoaWxkOkRpc3BsYXlPYmplY3QpXHJcblx0e1xyXG5cdFx0dGhpcy5faVNjZW5lR3JhcGhSb290LnJlbW92ZUNoaWxkKGNoaWxkKTtcclxuXHR9XHJcblxyXG5cdHB1YmxpYyByZW1vdmVDaGlsZEF0KGluZGV4Om51bWJlcilcclxuXHR7XHJcblx0XHR0aGlzLl9pU2NlbmVHcmFwaFJvb3QucmVtb3ZlQ2hpbGRBdChpbmRleCk7XHJcblx0fVxyXG5cclxuXHJcblx0cHVibGljIGdldENoaWxkQXQoaW5kZXg6bnVtYmVyKTpEaXNwbGF5T2JqZWN0XHJcblx0e1xyXG5cdFx0cmV0dXJuIHRoaXMuX2lTY2VuZUdyYXBoUm9vdC5nZXRDaGlsZEF0KGluZGV4KTtcclxuXHR9XHJcblxyXG5cdHB1YmxpYyBnZXQgbnVtQ2hpbGRyZW4oKTpudW1iZXJcclxuXHR7XHJcblx0XHRyZXR1cm4gdGhpcy5faVNjZW5lR3JhcGhSb290Lm51bUNoaWxkcmVuO1xyXG5cdH1cclxuXHJcblx0LyoqXHJcblx0ICogQGludGVybmFsXHJcblx0ICovXHJcblx0cHVibGljIGlSZWdpc3RlckVudGl0eShkaXNwbGF5T2JqZWN0OkRpc3BsYXlPYmplY3QpXHJcblx0e1xyXG5cdFx0aWYgKGRpc3BsYXlPYmplY3QucGFydGl0aW9uKVxyXG5cdFx0XHR0aGlzLmlSZWdpc3RlclBhcnRpdGlvbihkaXNwbGF5T2JqZWN0LnBhcnRpdGlvbik7XHJcblxyXG5cdFx0aWYgKGRpc3BsYXlPYmplY3QuaXNFbnRpdHkpXHJcblx0XHRcdGRpc3BsYXlPYmplY3QuX2lBc3NpZ25lZFBhcnRpdGlvbi5pTWFya0ZvclVwZGF0ZShkaXNwbGF5T2JqZWN0KTtcclxuXHR9XHJcblxyXG5cdC8qKlxyXG5cdCAqIEBpbnRlcm5hbFxyXG5cdCAqL1xyXG5cdHB1YmxpYyBpUmVnaXN0ZXJQYXJ0aXRpb24ocGFydGl0aW9uOlBhcnRpdGlvbilcclxuXHR7XHJcblx0XHR0aGlzLl9leHBhbmRlZFBhcnRpdGlvbnMucHVzaChwYXJ0aXRpb24pO1xyXG5cclxuXHRcdC8vZW5zdXJlIGR1cGxpY2F0ZXMgYXJlIG5vdCBmb3VuZCBpbiBwYXJ0aXRpb25zIGFycmF5XHJcblx0XHRpZiAodGhpcy5fcGFydGl0aW9ucy5pbmRleE9mKHBhcnRpdGlvbikgPT0gLTEpXHJcblx0XHRcdHRoaXMuX3BhcnRpdGlvbnMucHVzaChwYXJ0aXRpb24pO1xyXG5cdH1cclxuXHJcblx0LyoqXHJcblx0ICogQGludGVybmFsXHJcblx0ICovXHJcblx0cHVibGljIGlVbnJlZ2lzdGVyRW50aXR5KGRpc3BsYXlPYmplY3Q6RGlzcGxheU9iamVjdClcclxuXHR7XHJcblx0XHRpZiAoZGlzcGxheU9iamVjdC5wYXJ0aXRpb24pXHJcblx0XHRcdHRoaXMuaVVucmVnaXN0ZXJQYXJ0aXRpb24oZGlzcGxheU9iamVjdC5wYXJ0aXRpb24pO1xyXG5cclxuXHRcdGlmIChkaXNwbGF5T2JqZWN0LmlzRW50aXR5KVxyXG5cdFx0XHRkaXNwbGF5T2JqZWN0Ll9pQXNzaWduZWRQYXJ0aXRpb24uaVJlbW92ZUVudGl0eShkaXNwbGF5T2JqZWN0KTtcclxuXHR9XHJcblxyXG5cdC8qKlxyXG5cdCAqIEBpbnRlcm5hbFxyXG5cdCAqL1xyXG5cdHB1YmxpYyBpVW5yZWdpc3RlclBhcnRpdGlvbihwYXJ0aXRpb246UGFydGl0aW9uKVxyXG5cdHtcclxuXHRcdHRoaXMuX2V4cGFuZGVkUGFydGl0aW9ucy5zcGxpY2UodGhpcy5fZXhwYW5kZWRQYXJ0aXRpb25zLmluZGV4T2YocGFydGl0aW9uKSwgMSk7XHJcblxyXG5cdFx0Ly9pZiBubyBtb3JlIHBhcnRpdGlvbiByZWZlcmVuY2VzIGZvdW5kLCByZW1vdmUgZnJvbSBwYXJ0aXRpb25zIGFycmF5XHJcblx0XHRpZiAodGhpcy5fZXhwYW5kZWRQYXJ0aXRpb25zLmluZGV4T2YocGFydGl0aW9uKSA9PSAtMSlcclxuXHRcdFx0dGhpcy5fcGFydGl0aW9ucy5zcGxpY2UodGhpcy5fcGFydGl0aW9ucy5pbmRleE9mKHBhcnRpdGlvbiksIDEpO1xyXG5cdH1cclxufVxyXG5cclxuZXhwb3J0ID0gU2NlbmU7Il19