var __extends = this.__extends || function (d, b) {
    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];
    function __() { this.constructor = d; }
    __.prototype = b.prototype;
    d.prototype = new __();
};
var AssetType = require("awayjs-core/lib/library/AssetType");
var AbstractMethodError = require("awayjs-core/lib/errors/AbstractMethodError");
var DisplayObjectContainer = require("awayjs-display/lib/containers/DisplayObjectContainer");
var LightEvent = require("awayjs-display/lib/events/LightEvent");
var LightBase = (function (_super) {
    __extends(LightBase, _super);
    function LightBase() {
        _super.call(this);
        this._color = 0xffffff;
        this._colorR = 1;
        this._colorG = 1;
        this._colorB = 1;
        this._ambientColor = 0xffffff;
        this._ambient = 0;
        this._iAmbientR = 0;
        this._iAmbientG = 0;
        this._iAmbientB = 0;
        this._specular = 1;
        this._iSpecularR = 1;
        this._iSpecularG = 1;
        this._iSpecularB = 1;
        this._diffuse = 1;
        this._iDiffuseR = 1;
        this._iDiffuseG = 1;
        this._iDiffuseB = 1;
        this._castsShadows = false;
    }
    Object.defineProperty(LightBase.prototype, "castsShadows", {
        get: function () {
            return this._castsShadows;
        },
        set: function (value) {
            if (this._castsShadows == value)
                return;
            this._castsShadows = value;
            if (value) {
                if (this._shadowMapper == null)
                    this._shadowMapper = this.pCreateShadowMapper();
                this._shadowMapper.light = this;
            }
            else {
                this._shadowMapper.dispose();
                this._shadowMapper = null;
            }
            //*/
            this.dispatchEvent(new LightEvent(LightEvent.CASTS_SHADOW_CHANGE));
        },
        enumerable: true,
        configurable: true
    });
    LightBase.prototype.pCreateShadowMapper = function () {
        throw new AbstractMethodError();
    };
    Object.defineProperty(LightBase.prototype, "specular", {
        get: function () {
            return this._specular;
        },
        set: function (value) {
            if (value < 0)
                value = 0;
            this._specular = value;
            this.updateSpecular();
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(LightBase.prototype, "diffuse", {
        get: function () {
            return this._diffuse;
        },
        set: function (value) {
            if (value < 0)
                value = 0;
            this._diffuse = value;
            this.updateDiffuse();
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(LightBase.prototype, "color", {
        get: function () {
            return this._color;
        },
        set: function (value) {
            this._color = value;
            this._colorR = ((this._color >> 16) & 0xff) / 0xff;
            this._colorG = ((this._color >> 8) & 0xff) / 0xff;
            this._colorB = (this._color & 0xff) / 0xff;
            this.updateDiffuse();
            this.updateSpecular();
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(LightBase.prototype, "ambient", {
        get: function () {
            return this._ambient;
        },
        set: function (value) {
            if (value < 0)
                value = 0;
            else if (value > 1)
                value = 1;
            this._ambient = value;
            this.updateAmbient();
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(LightBase.prototype, "ambientColor", {
        get: function () {
            return this._ambientColor;
        },
        set: function (value) {
            this._ambientColor = value;
            this.updateAmbient();
        },
        enumerable: true,
        configurable: true
    });
    LightBase.prototype.updateAmbient = function () {
        this._iAmbientR = ((this._ambientColor >> 16) & 0xff) / 0xff * this._ambient;
        this._iAmbientG = ((this._ambientColor >> 8) & 0xff) / 0xff * this._ambient;
        this._iAmbientB = (this._ambientColor & 0xff) / 0xff * this._ambient;
    };
    LightBase.prototype.iGetObjectProjectionMatrix = function (entity, camera, target) {
        if (target === void 0) { target = null; }
        throw new AbstractMethodError();
    };
    Object.defineProperty(LightBase.prototype, "assetType", {
        //@override
        get: function () {
            return AssetType.LIGHT;
        },
        enumerable: true,
        configurable: true
    });
    LightBase.prototype.updateSpecular = function () {
        this._iSpecularR = this._colorR * this._specular;
        this._iSpecularG = this._colorG * this._specular;
        this._iSpecularB = this._colorB * this._specular;
    };
    LightBase.prototype.updateDiffuse = function () {
        this._iDiffuseR = this._colorR * this._diffuse;
        this._iDiffuseG = this._colorG * this._diffuse;
        this._iDiffuseB = this._colorB * this._diffuse;
    };
    Object.defineProperty(LightBase.prototype, "shadowMapper", {
        get: function () {
            return this._shadowMapper;
        },
        set: function (value) {
            this._shadowMapper = value;
            this._shadowMapper.light = this;
        },
        enumerable: true,
        configurable: true
    });
    return LightBase;
})(DisplayObjectContainer);
module.exports = LightBase;

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImF3YXlqcy1kaXNwbGF5L2xpYi9iYXNlL0xpZ2h0QmFzZS50cyJdLCJuYW1lcyI6WyJMaWdodEJhc2UiLCJMaWdodEJhc2UuY29uc3RydWN0b3IiLCJMaWdodEJhc2UuY2FzdHNTaGFkb3dzIiwiTGlnaHRCYXNlLnBDcmVhdGVTaGFkb3dNYXBwZXIiLCJMaWdodEJhc2Uuc3BlY3VsYXIiLCJMaWdodEJhc2UuZGlmZnVzZSIsIkxpZ2h0QmFzZS5jb2xvciIsIkxpZ2h0QmFzZS5hbWJpZW50IiwiTGlnaHRCYXNlLmFtYmllbnRDb2xvciIsIkxpZ2h0QmFzZS51cGRhdGVBbWJpZW50IiwiTGlnaHRCYXNlLmlHZXRPYmplY3RQcm9qZWN0aW9uTWF0cml4IiwiTGlnaHRCYXNlLmFzc2V0VHlwZSIsIkxpZ2h0QmFzZS51cGRhdGVTcGVjdWxhciIsIkxpZ2h0QmFzZS51cGRhdGVEaWZmdXNlIiwiTGlnaHRCYXNlLnNoYWRvd01hcHBlciJdLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQUEsSUFBTyxTQUFTLFdBQWMsbUNBQW1DLENBQUMsQ0FBQztBQUVuRSxJQUFPLG1CQUFtQixXQUFZLDRDQUE0QyxDQUFDLENBQUM7QUFFcEYsSUFBTyxzQkFBc0IsV0FBVyxzREFBc0QsQ0FBQyxDQUFDO0FBR2hHLElBQU8sVUFBVSxXQUFjLHNDQUFzQyxDQUFDLENBQUM7QUFHdkUsSUFBTSxTQUFTO0lBQVNBLFVBQWxCQSxTQUFTQSxVQUErQkE7SUEyQjdDQSxTQTNCS0EsU0FBU0E7UUE2QmJDLGlCQUFPQSxDQUFDQTtRQTNCREEsV0FBTUEsR0FBVUEsUUFBUUEsQ0FBQ0E7UUFDekJBLFlBQU9BLEdBQVVBLENBQUNBLENBQUNBO1FBQ25CQSxZQUFPQSxHQUFVQSxDQUFDQSxDQUFDQTtRQUNuQkEsWUFBT0EsR0FBVUEsQ0FBQ0EsQ0FBQ0E7UUFFbkJBLGtCQUFhQSxHQUFVQSxRQUFRQSxDQUFDQTtRQUNoQ0EsYUFBUUEsR0FBVUEsQ0FBQ0EsQ0FBQ0E7UUFDckJBLGVBQVVBLEdBQVVBLENB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QSxJQUFJQSxDQUFDQSxTQUFTQSxDQUFDQTtRQUMvQ0EsSUFBSUEsQ0FBQ0EsV0FBV0EsR0FBR0EsSUFBSUEsQ0FBQ0EsT0FBT0EsR0FBQ0EsSUFBSUEsQ0FBQ0EsU0FBU0EsQ0FBQ0E7UUFDL0NBLElBQUlBLENBQUNBLFdBQVdBLEdBQUdBLElBQUlBLENBQUNBLE9BQU9BLEdBQUNBLElBQUlBLENBQUNBLFNBQVNBLENBQUNBO0lBQ2hEQSxDQUFDQTtJQUVPWixpQ0FBYUEsR0FBckJBO1FBRUNhLElBQUlBLENBQUNBLFVBQVVBLEdBQUdBLElBQUlBLENBQUNBLE9BQU9BLEdBQUNBLElBQUlBLENBQUNBLFFBQVFBLENBQUNBO1FBQzdDQSxJQUFJQSxDQUFDQSxVQUFVQSxHQUFHQSxJQUFJQSxDQUFDQSxPQUFPQSxHQUFDQSxJQUFJQSxDQUFDQSxRQUFRQSxDQUFDQTtRQUM3Q0EsSUFBSUEsQ0FBQ0EsVUFBVUEsR0FBR0EsSUFBSUEsQ0FBQ0EsT0FBT0EsR0FBQ0EsSUFBSUEsQ0FBQ0EsUUFBUUEsQ0FBQ0E7SUFDOUNBLENBQUNBO0lBRURiLHNCQUFXQSxtQ0FBWUE7YUFBdkJBO1lBRUNjLE1BQU1BLENBQUNBLElBQUlBLENBQUNBLGFBQWFBLENBQUNBO1FBQzNCQSxDQUFDQTthQUVEZCxVQUF3QkEsS0FBc0JBO1lBRTdDYyxJQUFJQSxDQUFDQSxhQUFhQSxHQUFHQSxLQUFLQSxDQUFDQTtZQUMzQkEsSUFBSUEsQ0FBQ0EsYUFBYUEsQ0FBQ0EsS0FBS0EsR0FBR0EsSUFBSUEsQ0FBQ0E7UUFDakNBLENBQUNBOzs7T0FOQWQ7SUFPRkEsZ0JBQUNBO0FBQURBLENBL0tBLEFBK0tDQSxFQS9LdUIsc0JBQXNCLEVBK0s3QztBQUVELEFBQW1CLGlCQUFWLFNBQVMsQ0FBQyIsImZpbGUiOiJiYXNlL0xpZ2h0QmFzZS5qcyIsInNvdXJjZVJvb3QiOiIuLi8iLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgQXNzZXRUeXBlXHRcdFx0XHQ9IHJlcXVpcmUoXCJhd2F5anMtY29yZS9saWIvbGlicmFyeS9Bc3NldFR5cGVcIik7XG5pbXBvcnQgTWF0cml4M0RcdFx0XHRcdFx0PSByZXF1aXJlKFwiYXdheWpzLWNvcmUvbGliL2dlb20vTWF0cml4M0RcIik7XG5pbXBvcnQgQWJzdHJhY3RNZXRob2RFcnJvclx0XHQ9IHJlcXVpcmUoXCJhd2F5anMtY29yZS9saWIvZXJyb3JzL0Fic3RyYWN0TWV0aG9kRXJyb3JcIik7XG5cbmltcG9ydCBEaXNwbGF5T2JqZWN0Q29udGFpbmVyXHQ9IHJlcXVpcmUoXCJhd2F5anMtZGlzcGxheS9saWIvY29udGFpbmVycy9EaXNwbGF5T2JqZWN0Q29udGFpbmVyXCIpO1xuaW1wb3J0IENhbWVyYVx0XHRcdFx0XHQ9IHJlcXVpcmUoXCJhd2F5anMtZGlzcGxheS9saWIvZW50aXRpZXMvQ2FtZXJhXCIpO1xuaW1wb3J0IElFbnRpdHlcdFx0XHRcdFx0PSByZXF1aXJlKFwiYXdheWpzLWRpc3BsYXkvbGliL2VudGl0aWVzL0lFbnRpdHlcIik7XG5pbXBvcnQgTGlnaHRFdmVudFx0XHRcdFx0PSByZXF1aXJlKFwiYXdheWpzLWRpc3BsYXkvbGliL2V2ZW50cy9MaWdodEV2ZW50XCIpO1xuaW1wb3J0IFNoYWRvd01hcHBlckJhc2VcdFx0XHQ9IHJlcXVpcmUoXCJhd2F5anMtZGlzcGxheS9saWIvbWF0ZXJpYWxzL3NoYWRvd21hcHBlcnMvU2hhZG93TWFwcGVyQmFzZVwiKTtcblxuY2xhc3MgTGlnaHRCYXNlIGV4dGVuZHMgRGlzcGxheU9iamVjdENvbnRhaW5lclxue1xuXHRwcml2YXRlIF9jb2xvcjpudW1iZXIgPSAweGZmZmZmZjtcblx0cHJpdmF0ZSBfY29sb3JSOm51bWJlciA9IDE7XG5cdHByaXZhdGUgX2NvbG9yRzpudW1iZXIgPSAxO1xuXHRwcml2YXRlIF9jb2xvckI6bnVtYmVyID0gMTtcblxuXHRwcml2YXRlIF9hbWJpZW50Q29sb3I6bnVtYmVyID0gMHhmZmZmZmY7XG5cdHByaXZhdGUgX2FtYmllbnQ6bnVtYmVyID0gMDtcblx0cHVibGljIF9pQW1iaWVudFI6bnVtYmVyID0gMDtcblx0cHVibGljIF9pQW1iaWVudEc6bnVtYmVyID0gMDtcblx0cHVibGljIF9pQW1iaWVudEI6bnVtYmVyID0gMDtcblxuXHRwcml2YXRlIF9zcGVjdWxhcjpudW1iZXIgPSAxO1xuXHRwdWJsaWMgX2lTcGVjdWxhclI6bnVtYmVyID0gMTtcblx0cHVibGljIF9pU3BlY3VsYXJHOm51bWJlciA9IDE7XG5cdHB1YmxpYyBfaVNwZWN1bGFyQjpudW1iZXIgPSAxO1xuXG5cdHByaXZhdGUgX2RpZmZ1c2U6bnVtYmVyID0gMTtcblx0cHVibGljIF9pRGlmZnVzZVI6bnVtYmVyID0gMTtcblx0cHVibGljIF9pRGlmZnVzZUc6bnVtYmVyID0gMTtcblx0cHVibGljIF9pRGlmZnVzZUI6bnVtYmVyID0gMTtcblxuXHRwcml2YXRlIF9jYXN0c1NoYWRvd3M6Ym9vbGVhbiA9IGZhbHNlO1xuXG5cdHByaXZhdGUgX3NoYWRvd01hcHBlcjpTaGFkb3dNYXBwZXJCYXNlO1xuXG5cdGNvbnN0cnVjdG9yKClcblx0e1xuXHRcdHN1cGVyKCk7XG5cdH1cblxuXHRwdWJsaWMgZ2V0IGNhc3RzU2hhZG93cygpOmJvb2xlYW5cblx0e1xuXHRcdHJldHVybiB0aGlzLl9jYXN0c1NoYWRvd3M7XG5cdH1cblxuXHRwdWJsaWMgc2V0IGNhc3RzU2hhZG93cyh2YWx1ZTpib29sZWFuKVxuXHR7XG5cdFx0aWYgKHRoaXMuX2Nhc3RzU2hhZG93cyA9PSB2YWx1ZSlcblx0XHRcdHJldHVybjtcblxuXHRcdHRoaXMuX2Nhc3RzU2hhZG93cyA9IHZhbHVlO1xuXG5cdFx0aWYgKHZhbHVlKSB7XG5cdFx0XHRpZiAodGhpcy5fc2hhZG93TWFwcGVyID09IG51bGwpXG5cdFx0XHRcdHRoaXMuX3NoYWRvd01hcHBlciA9IHRoaXMucENyZWF0ZVNoYWRvd01hcHBlcigpO1xuXG5cdFx0XHR0aGlzLl9zaGFkb3dNYXBwZXIubGlnaHQgPSB0aGlzO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHR0aGlzLl9zaGFkb3dNYXBwZXIuZGlzcG9zZSgpO1xuXHRcdFx0dGhpcy5fc2hhZG93TWFwcGVyID0gbnVsbDtcblx0XHR9XG5cdFx0Ly8qL1xuXHRcdHRoaXMuZGlzcGF0Y2hFdmVudChuZXcgTGlnaHRFdmVudChMaWdodEV2ZW50LkNBU1RTX1NIQURPV19DSEFOR0UpKTtcblx0fVxuXG5cdHB1YmxpYyBwQ3JlYXRlU2hhZG93TWFwcGVyKCk6U2hhZG93TWFwcGVyQmFzZVxuXHR7XG5cdFx0dGhyb3cgbmV3IEFic3RyYWN0TWV0aG9kRXJyb3IoKTtcblx0fVxuXG5cdHB1YmxpYyBnZXQgc3BlY3VsYXIoKTpudW1iZXJcblx0e1xuXHRcdHJldHVybiB0aGlzLl9zcGVjdWxhcjtcblx0fVxuXG5cdHB1YmxpYyBzZXQgc3BlY3VsYXIodmFsdWU6bnVtYmVyKVxuXHR7XG5cdFx0aWYgKHZhbHVlIDwgMClcblx0XHRcdHZhbHVlID0gMDtcblxuXHRcdHRoaXMuX3NwZWN1bGFyID0gdmFsdWU7XG5cdFx0dGhpcy51cGRhdGVTcGVjdWxhcigpO1xuXHR9XG5cblx0cHVibGljIGdldCBkaWZmdXNlKCk6bnVtYmVyXG5cdHtcblx0XHRyZXR1cm4gdGhpcy5fZGlmZnVzZTtcblx0fVxuXG5cdHB1YmxpYyBzZXQgZGlmZnVzZSh2YWx1ZTpudW1iZXIpXG5cdHtcblx0XHRpZiAodmFsdWUgPCAwKVxuXHRcdFx0dmFsdWUgPSAwO1xuXG5cdFx0dGhpcy5fZGlmZnVzZSA9IHZhbHVlO1xuXHRcdHRoaXMudXBkYXRlRGlmZnVzZSgpO1xuXHR9XG5cblx0cHVibGljIGdldCBjb2xvcigpOm51bWJlclxuXHR7XG5cdFx0cmV0dXJuIHRoaXMuX2NvbG9yO1xuXHR9XG5cblx0cHVibGljIHNldCBjb2xvcih2YWx1ZTpudW1iZXIpXG5cdHtcblx0XHR0aGlzLl9jb2xvciA9IHZhbHVlO1xuXHRcdHRoaXMuX2NvbG9yUiA9ICgodGhpcy5fY29sb3IgPj4gMTYpICYgMHhmZikvMHhmZjtcblx0XHR0aGlzLl9jb2xvckcgPSAoKHRoaXMuX2NvbG9yID4+IDgpICYgMHhmZikvMHhmZjtcblx0XHR0aGlzLl9jb2xvckIgPSAodGhpcy5fY29sb3IgJiAweGZmKS8weGZmO1xuXG5cdFx0dGhpcy51cGRhdGVEaWZmdXNlKCk7XG5cdFx0dGhpcy51cGRhdGVTcGVjdWxhcigpO1xuXHR9XG5cblx0cHVibGljIGdldCBhbWJpZW50KCk6bnVtYmVyXG5cdHtcblx0XHRyZXR1cm4gdGhpcy5fYW1iaWVudDtcblx0fVxuXG5cdHB1YmxpYyBzZXQgYW1iaWVudCh2YWx1ZTpudW1iZXIpXG5cdHtcblx0XHRpZiAodmFsdWUgPCAwKVxuXHRcdFx0dmFsdWUgPSAwO1xuXHRcdGVsc2UgaWYgKHZhbHVlID4gMSlcblx0XHRcdHZhbHVlID0gMTtcblxuXHRcdHRoaXMuX2FtYmllbnQgPSB2YWx1ZTtcblx0XHR0aGlzLnVwZGF0ZUFtYmllbnQoKTtcblx0fVxuXG5cdHB1YmxpYyBnZXQgYW1iaWVudENvbG9yKCk6bnVtYmVyXG5cdHtcblx0XHRyZXR1cm4gdGhpcy5fYW1iaWVudENvbG9yO1xuXHR9XG5cblx0cHVibGljIHNldCBhbWJpZW50Q29sb3IodmFsdWU6bnVtYmVyKVxuXHR7XG5cdFx0dGhpcy5fYW1iaWVudENvbG9yID0gdmFsdWU7XG5cdFx0dGhpcy51cGRhdGVBbWJpZW50KCk7XG5cdH1cblxuXHRwcml2YXRlIHVwZGF0ZUFtYmllbnQoKVxuXHR7XG5cdFx0dGhpcy5faUFtYmllbnRSID0gKCh0aGlzLl9hbWJpZW50Q29sb3IgPj4gMTYpICYgMHhmZikvMHhmZip0aGlzLl9hbWJpZW50O1xuXHRcdHRoaXMuX2lBbWJpZW50RyA9ICgodGhpcy5fYW1iaWVudENvbG9yID4+IDgpICYgMHhmZikvMHhmZip0aGlzLl9hbWJpZW50O1xuXHRcdHRoaXMuX2lBbWJpZW50QiA9ICh0aGlzLl9hbWJpZW50Q29sb3IgJiAweGZmKS8weGZmKnRoaXMuX2FtYmllbnQ7XG5cdH1cblxuXHRwdWJsaWMgaUdldE9iamVjdFByb2plY3Rpb25NYXRyaXgoZW50aXR5OklFbnRpdHksIGNhbWVyYTpDYW1lcmEsIHRhcmdldDpNYXRyaXgzRCA9IG51bGwpOk1hdHJpeDNEXG5cdHtcblx0XHR0aHJvdyBuZXcgQWJzdHJhY3RNZXRob2RFcnJvcigpO1xuXHR9XG5cblx0Ly9Ab3ZlcnJpZGVcblx0cHVibGljIGdldCBhc3NldFR5cGUoKTpzdHJpbmdcblx0e1xuXHRcdHJldHVybiBBc3NldFR5cGUuTElHSFQ7XG5cdH1cblxuXHRwcml2YXRlIHVwZGF0ZVNwZWN1bGFyKClcblx0e1xuXHRcdHRoaXMuX2lTcGVjdWxhclIgPSB0aGlzLl9jb2xvclIqdGhpcy5fc3BlY3VsYXI7XG5cdFx0dGhpcy5faVNwZWN1bGFyRyA9IHRoaXMuX2NvbG9yRyp0aGlzLl9zcGVjdWxhcjtcblx0XHR0aGlzLl9pU3BlY3VsYXJCID0gdGhpcy5fY29sb3JCKnRoaXMuX3NwZWN1bGFyO1xuXHR9XG5cblx0cHJpdmF0ZSB1cGRhdGVEaWZmdXNlKClcblx0e1xuXHRcdHRoaXMuX2lEaWZmdXNlUiA9IHRoaXMuX2NvbG9yUip0aGlzLl9kaWZmdXNlO1xuXHRcdHRoaXMuX2lEaWZmdXNlRyA9IHRoaXMuX2NvbG9yRyp0aGlzLl9kaWZmdXNlO1xuXHRcdHRoaXMuX2lEaWZmdXNlQiA9IHRoaXMuX2NvbG9yQip0aGlzLl9kaWZmdXNlO1xuXHR9XG5cblx0cHVibGljIGdldCBzaGFkb3dNYXBwZXIoKTpTaGFkb3dNYXBwZXJCYXNlXG5cdHtcblx0XHRyZXR1cm4gdGhpcy5fc2hhZG93TWFwcGVyO1xuXHR9XG5cblx0cHVibGljIHNldCBzaGFkb3dNYXBwZXIodmFsdWU6U2hhZG93TWFwcGVyQmFzZSlcblx0e1xuXHRcdHRoaXMuX3NoYWRvd01hcHBlciA9IHZhbHVlO1xuXHRcdHRoaXMuX3NoYWRvd01hcHBlci5saWdodCA9IHRoaXM7XG5cdH1cbn1cblxuZXhwb3J0ID0gTGlnaHRCYXNlOyJdfQ==