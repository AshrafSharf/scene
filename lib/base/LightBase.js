var __extends = this.__extends || function (d, b) {
    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];
    function __() { this.constructor = d; }
    __.prototype = b.prototype;
    d.prototype = new __();
};
var AssetType = require("awayjs-core/lib/library/AssetType");
var AbstractMethodError = require("awayjs-core/lib/errors/AbstractMethodError");
var DisplayObjectContainer = require("awayjs-display/lib/containers/DisplayObjectContainer");
var LightEvent = require("awayjs-display/lib/events/LightEvent");
var LightBase = (function (_super) {
    __extends(LightBase, _super);
    function LightBase() {
        _super.call(this);
        this._color = 0xffffff;
        this._colorR = 1;
        this._colorG = 1;
        this._colorB = 1;
        this._ambientColor = 0xffffff;
        this._ambient = 0;
        this._iAmbientR = 0;
        this._iAmbientG = 0;
        this._iAmbientB = 0;
        this._specular = 1;
        this._iSpecularR = 1;
        this._iSpecularG = 1;
        this._iSpecularB = 1;
        this._diffuse = 1;
        this._iDiffuseR = 1;
        this._iDiffuseG = 1;
        this._iDiffuseB = 1;
        this._castsShadows = false;
    }
    Object.defineProperty(LightBase.prototype, "castsShadows", {
        get: function () {
            return this._castsShadows;
        },
        set: function (value) {
            if (this._castsShadows == value)
                return;
            this._castsShadows = value;
            if (value) {
                if (this._shadowMapper == null)
                    this._shadowMapper = this.pCreateShadowMapper();
                this._shadowMapper.light = this;
            }
            else {
                this._shadowMapper.dispose();
                this._shadowMapper = null;
            }
            //*/
            this.dispatchEvent(new LightEvent(LightEvent.CASTS_SHADOW_CHANGE));
        },
        enumerable: true,
        configurable: true
    });
    LightBase.prototype.pCreateShadowMapper = function () {
        throw new AbstractMethodError();
    };
    Object.defineProperty(LightBase.prototype, "specular", {
        get: function () {
            return this._specular;
        },
        set: function (value) {
            if (value < 0)
                value = 0;
            this._specular = value;
            this.updateSpecular();
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(LightBase.prototype, "diffuse", {
        get: function () {
            return this._diffuse;
        },
        set: function (value) {
            if (value < 0)
                value = 0;
            this._diffuse = value;
            this.updateDiffuse();
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(LightBase.prototype, "color", {
        get: function () {
            return this._color;
        },
        set: function (value) {
            this._color = value;
            this._colorR = ((this._color >> 16) & 0xff) / 0xff;
            this._colorG = ((this._color >> 8) & 0xff) / 0xff;
            this._colorB = (this._color & 0xff) / 0xff;
            this.updateDiffuse();
            this.updateSpecular();
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(LightBase.prototype, "ambient", {
        get: function () {
            return this._ambient;
        },
        set: function (value) {
            if (value < 0)
                value = 0;
            else if (value > 1)
                value = 1;
            this._ambient = value;
            this.updateAmbient();
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(LightBase.prototype, "ambientColor", {
        get: function () {
            return this._ambientColor;
        },
        set: function (value) {
            this._ambientColor = value;
            this.updateAmbient();
        },
        enumerable: true,
        configurable: true
    });
    LightBase.prototype.updateAmbient = function () {
        this._iAmbientR = ((this._ambientColor >> 16) & 0xff) / 0xff * this._ambient;
        this._iAmbientG = ((this._ambientColor >> 8) & 0xff) / 0xff * this._ambient;
        this._iAmbientB = (this._ambientColor & 0xff) / 0xff * this._ambient;
    };
    LightBase.prototype.iGetObjectProjectionMatrix = function (entity, camera, target) {
        if (target === void 0) { target = null; }
        throw new AbstractMethodError();
    };
    Object.defineProperty(LightBase.prototype, "assetType", {
        //@override
        get: function () {
            return AssetType.LIGHT;
        },
        enumerable: true,
        configurable: true
    });
    LightBase.prototype.updateSpecular = function () {
        this._iSpecularR = this._colorR * this._specular;
        this._iSpecularG = this._colorG * this._specular;
        this._iSpecularB = this._colorB * this._specular;
    };
    LightBase.prototype.updateDiffuse = function () {
        this._iDiffuseR = this._colorR * this._diffuse;
        this._iDiffuseG = this._colorG * this._diffuse;
        this._iDiffuseB = this._colorB * this._diffuse;
    };
    Object.defineProperty(LightBase.prototype, "shadowMapper", {
        get: function () {
            return this._shadowMapper;
        },
        set: function (value) {
            this._shadowMapper = value;
            this._shadowMapper.light = this;
        },
        enumerable: true,
        configurable: true
    });
    return LightBase;
})(DisplayObjectContainer);
module.exports = LightBase;

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImF3YXlqcy1kaXNwbGF5L2xpYi9iYXNlL0xpZ2h0QmFzZS50cyJdLCJuYW1lcyI6WyJMaWdodEJhc2UiLCJMaWdodEJhc2UuY29uc3RydWN0b3IiLCJMaWdodEJhc2UuY2FzdHNTaGFkb3dzIiwiTGlnaHRCYXNlLnBDcmVhdGVTaGFkb3dNYXBwZXIiLCJMaWdodEJhc2Uuc3BlY3VsYXIiLCJMaWdodEJhc2UuZGlmZnVzZSIsIkxpZ2h0QmFzZS5jb2xvciIsIkxpZ2h0QmFzZS5hbWJpZW50IiwiTGlnaHRCYXNlLmFtYmllbnRDb2xvciIsIkxpZ2h0QmFzZS51cGRhdGVBbWJpZW50IiwiTGlnaHRCYXNlLmlHZXRPYmplY3RQcm9qZWN0aW9uTWF0cml4IiwiTGlnaHRCYXNlLmFzc2V0VHlwZSIsIkxpZ2h0QmFzZS51cGRhdGVTcGVjdWxhciIsIkxpZ2h0QmFzZS51cGRhdGVEaWZmdXNlIiwiTGlnaHRCYXNlLnNoYWRvd01hcHBlciJdLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQUEsSUFBTyxTQUFTLFdBQWMsbUNBQW1DLENBQUMsQ0FBQztBQUVuRSxJQUFPLG1CQUFtQixXQUFZLDRDQUE0QyxDQUFDLENBQUM7QUFFcEYsSUFBTyxzQkFBc0IsV0FBVyxzREFBc0QsQ0FBQyxDQUFDO0FBR2hHLElBQU8sVUFBVSxXQUFjLHNDQUFzQyxDQUFDLENBQUM7QUFHdkUsSUFBTSxTQUFTO0lBQVNBLFVBQWxCQSxTQUFTQSxVQUErQkE7SUEyQjdDQSxTQTNCS0EsU0FBU0E7UUE2QmJDLGlCQUFPQSxDQUFDQTtRQTNCREEsV0FBTUEsR0FBVUEsUUFBUUEsQ0FBQ0E7UUFDekJBLFlBQU9BLEdBQVVBLENBQUNBLENBQUNBO1FBQ25CQSxZQUFPQSxHQUFVQSxDQUFDQSxDQUFDQTtRQUNuQkEsWUFBT0EsR0FBVUEsQ0FBQ0EsQ0FBQ0E7UUFFbkJBLGtCQUFhQSxHQUFVQSxRQUFRQSxDQUFDQTtRQUNoQ0EsYUFBUUEsR0FBVUEsQ0FBQ0EsQ0FBQ0E7UUFDckJBLGVBQVVBLEdBQVVBLENB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QSxJQUFJQSxDQUFDQSxTQUFTQSxDQUFDQTtRQUMvQ0EsSUFBSUEsQ0FBQ0EsV0FBV0EsR0FBR0EsSUFBSUEsQ0FBQ0EsT0FBT0EsR0FBQ0EsSUFBSUEsQ0FBQ0EsU0FBU0EsQ0FBQ0E7UUFDL0NBLElBQUlBLENBQUNBLFdBQVdBLEdBQUdBLElBQUlBLENBQUNBLE9BQU9BLEdBQUNBLElBQUlBLENBQUNBLFNBQVNBLENBQUNBO0lBQ2hEQSxDQUFDQTtJQUVPWixpQ0FBYUEsR0FBckJBO1FBRUNhLElBQUlBLENBQUNBLFVBQVVBLEdBQUdBLElBQUlBLENBQUNBLE9BQU9BLEdBQUNBLElBQUlBLENBQUNBLFFBQVFBLENBQUNBO1FBQzdDQSxJQUFJQSxDQUFDQSxVQUFVQSxHQUFHQSxJQUFJQSxDQUFDQSxPQUFPQSxHQUFDQSxJQUFJQSxDQUFDQSxRQUFRQSxDQUFDQTtRQUM3Q0EsSUFBSUEsQ0FBQ0EsVUFBVUEsR0FBR0EsSUFBSUEsQ0FBQ0EsT0FBT0EsR0FBQ0EsSUFBSUEsQ0FBQ0EsUUFBUUEsQ0FBQ0E7SUFDOUNBLENBQUNBO0lBRURiLHNCQUFXQSxtQ0FBWUE7YUFBdkJBO1lBRUNjLE1BQU1BLENBQUNBLElBQUlBLENBQUNBLGFBQWFBLENBQUNBO1FBQzNCQSxDQUFDQTthQUVEZCxVQUF3QkEsS0FBc0JBO1lBRTdDYyxJQUFJQSxDQUFDQSxhQUFhQSxHQUFHQSxLQUFLQSxDQUFDQTtZQUMzQkEsSUFBSUEsQ0FBQ0EsYUFBYUEsQ0FBQ0EsS0FBS0EsR0FBR0EsSUFBSUEsQ0FBQ0E7UUFDakNBLENBQUNBOzs7T0FOQWQ7SUFPRkEsZ0JBQUNBO0FBQURBLENBL0tBLEFBK0tDQSxFQS9LdUIsc0JBQXNCLEVBK0s3QztBQUVELEFBQW1CLGlCQUFWLFNBQVMsQ0FBQyIsImZpbGUiOiJiYXNlL0xpZ2h0QmFzZS5qcyIsInNvdXJjZVJvb3QiOiIuLi8iLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgQXNzZXRUeXBlXHRcdFx0XHQ9IHJlcXVpcmUoXCJhd2F5anMtY29yZS9saWIvbGlicmFyeS9Bc3NldFR5cGVcIik7XHJcbmltcG9ydCBNYXRyaXgzRFx0XHRcdFx0XHQ9IHJlcXVpcmUoXCJhd2F5anMtY29yZS9saWIvZ2VvbS9NYXRyaXgzRFwiKTtcclxuaW1wb3J0IEFic3RyYWN0TWV0aG9kRXJyb3JcdFx0PSByZXF1aXJlKFwiYXdheWpzLWNvcmUvbGliL2Vycm9ycy9BYnN0cmFjdE1ldGhvZEVycm9yXCIpO1xyXG5cclxuaW1wb3J0IERpc3BsYXlPYmplY3RDb250YWluZXJcdD0gcmVxdWlyZShcImF3YXlqcy1kaXNwbGF5L2xpYi9jb250YWluZXJzL0Rpc3BsYXlPYmplY3RDb250YWluZXJcIik7XHJcbmltcG9ydCBDYW1lcmFcdFx0XHRcdFx0PSByZXF1aXJlKFwiYXdheWpzLWRpc3BsYXkvbGliL2VudGl0aWVzL0NhbWVyYVwiKTtcclxuaW1wb3J0IElFbnRpdHlcdFx0XHRcdFx0PSByZXF1aXJlKFwiYXdheWpzLWRpc3BsYXkvbGliL2VudGl0aWVzL0lFbnRpdHlcIik7XHJcbmltcG9ydCBMaWdodEV2ZW50XHRcdFx0XHQ9IHJlcXVpcmUoXCJhd2F5anMtZGlzcGxheS9saWIvZXZlbnRzL0xpZ2h0RXZlbnRcIik7XHJcbmltcG9ydCBTaGFkb3dNYXBwZXJCYXNlXHRcdFx0PSByZXF1aXJlKFwiYXdheWpzLWRpc3BsYXkvbGliL21hdGVyaWFscy9zaGFkb3dtYXBwZXJzL1NoYWRvd01hcHBlckJhc2VcIik7XHJcblxyXG5jbGFzcyBMaWdodEJhc2UgZXh0ZW5kcyBEaXNwbGF5T2JqZWN0Q29udGFpbmVyXHJcbntcclxuXHRwcml2YXRlIF9jb2xvcjpudW1iZXIgPSAweGZmZmZmZjtcclxuXHRwcml2YXRlIF9jb2xvclI6bnVtYmVyID0gMTtcclxuXHRwcml2YXRlIF9jb2xvckc6bnVtYmVyID0gMTtcclxuXHRwcml2YXRlIF9jb2xvckI6bnVtYmVyID0gMTtcclxuXHJcblx0cHJpdmF0ZSBfYW1iaWVudENvbG9yOm51bWJlciA9IDB4ZmZmZmZmO1xyXG5cdHByaXZhdGUgX2FtYmllbnQ6bnVtYmVyID0gMDtcclxuXHRwdWJsaWMgX2lBbWJpZW50UjpudW1iZXIgPSAwO1xyXG5cdHB1YmxpYyBfaUFtYmllbnRHOm51bWJlciA9IDA7XHJcblx0cHVibGljIF9pQW1iaWVudEI6bnVtYmVyID0gMDtcclxuXHJcblx0cHJpdmF0ZSBfc3BlY3VsYXI6bnVtYmVyID0gMTtcclxuXHRwdWJsaWMgX2lTcGVjdWxhclI6bnVtYmVyID0gMTtcclxuXHRwdWJsaWMgX2lTcGVjdWxhckc6bnVtYmVyID0gMTtcclxuXHRwdWJsaWMgX2lTcGVjdWxhckI6bnVtYmVyID0gMTtcclxuXHJcblx0cHJpdmF0ZSBfZGlmZnVzZTpudW1iZXIgPSAxO1xyXG5cdHB1YmxpYyBfaURpZmZ1c2VSOm51bWJlciA9IDE7XHJcblx0cHVibGljIF9pRGlmZnVzZUc6bnVtYmVyID0gMTtcclxuXHRwdWJsaWMgX2lEaWZmdXNlQjpudW1iZXIgPSAxO1xyXG5cclxuXHRwcml2YXRlIF9jYXN0c1NoYWRvd3M6Ym9vbGVhbiA9IGZhbHNlO1xyXG5cclxuXHRwcml2YXRlIF9zaGFkb3dNYXBwZXI6U2hhZG93TWFwcGVyQmFzZTtcclxuXHJcblx0Y29uc3RydWN0b3IoKVxyXG5cdHtcclxuXHRcdHN1cGVyKCk7XHJcblx0fVxyXG5cclxuXHRwdWJsaWMgZ2V0IGNhc3RzU2hhZG93cygpOmJvb2xlYW5cclxuXHR7XHJcblx0XHRyZXR1cm4gdGhpcy5fY2FzdHNTaGFkb3dzO1xyXG5cdH1cclxuXHJcblx0cHVibGljIHNldCBjYXN0c1NoYWRvd3ModmFsdWU6Ym9vbGVhbilcclxuXHR7XHJcblx0XHRpZiAodGhpcy5fY2FzdHNTaGFkb3dzID09IHZhbHVlKVxyXG5cdFx0XHRyZXR1cm47XHJcblxyXG5cdFx0dGhpcy5fY2FzdHNTaGFkb3dzID0gdmFsdWU7XHJcblxyXG5cdFx0aWYgKHZhbHVlKSB7XHJcblx0XHRcdGlmICh0aGlzLl9zaGFkb3dNYXBwZXIgPT0gbnVsbClcclxuXHRcdFx0XHR0aGlzLl9zaGFkb3dNYXBwZXIgPSB0aGlzLnBDcmVhdGVTaGFkb3dNYXBwZXIoKTtcclxuXHJcblx0XHRcdHRoaXMuX3NoYWRvd01hcHBlci5saWdodCA9IHRoaXM7XHJcblx0XHR9IGVsc2Uge1xyXG5cdFx0XHR0aGlzLl9zaGFkb3dNYXBwZXIuZGlzcG9zZSgpO1xyXG5cdFx0XHR0aGlzLl9zaGFkb3dNYXBwZXIgPSBudWxsO1xyXG5cdFx0fVxyXG5cdFx0Ly8qL1xyXG5cdFx0dGhpcy5kaXNwYXRjaEV2ZW50KG5ldyBMaWdodEV2ZW50KExpZ2h0RXZlbnQuQ0FTVFNfU0hBRE9XX0NIQU5HRSkpO1xyXG5cdH1cclxuXHJcblx0cHVibGljIHBDcmVhdGVTaGFkb3dNYXBwZXIoKTpTaGFkb3dNYXBwZXJCYXNlXHJcblx0e1xyXG5cdFx0dGhyb3cgbmV3IEFic3RyYWN0TWV0aG9kRXJyb3IoKTtcclxuXHR9XHJcblxyXG5cdHB1YmxpYyBnZXQgc3BlY3VsYXIoKTpudW1iZXJcclxuXHR7XHJcblx0XHRyZXR1cm4gdGhpcy5fc3BlY3VsYXI7XHJcblx0fVxyXG5cclxuXHRwdWJsaWMgc2V0IHNwZWN1bGFyKHZhbHVlOm51bWJlcilcclxuXHR7XHJcblx0XHRpZiAodmFsdWUgPCAwKVxyXG5cdFx0XHR2YWx1ZSA9IDA7XHJcblxyXG5cdFx0dGhpcy5fc3BlY3VsYXIgPSB2YWx1ZTtcclxuXHRcdHRoaXMudXBkYXRlU3BlY3VsYXIoKTtcclxuXHR9XHJcblxyXG5cdHB1YmxpYyBnZXQgZGlmZnVzZSgpOm51bWJlclxyXG5cdHtcclxuXHRcdHJldHVybiB0aGlzLl9kaWZmdXNlO1xyXG5cdH1cclxuXHJcblx0cHVibGljIHNldCBkaWZmdXNlKHZhbHVlOm51bWJlcilcclxuXHR7XHJcblx0XHRpZiAodmFsdWUgPCAwKVxyXG5cdFx0XHR2YWx1ZSA9IDA7XHJcblxyXG5cdFx0dGhpcy5fZGlmZnVzZSA9IHZhbHVlO1xyXG5cdFx0dGhpcy51cGRhdGVEaWZmdXNlKCk7XHJcblx0fVxyXG5cclxuXHRwdWJsaWMgZ2V0IGNvbG9yKCk6bnVtYmVyXHJcblx0e1xyXG5cdFx0cmV0dXJuIHRoaXMuX2NvbG9yO1xyXG5cdH1cclxuXHJcblx0cHVibGljIHNldCBjb2xvcih2YWx1ZTpudW1iZXIpXHJcblx0e1xyXG5cdFx0dGhpcy5fY29sb3IgPSB2YWx1ZTtcclxuXHRcdHRoaXMuX2NvbG9yUiA9ICgodGhpcy5fY29sb3IgPj4gMTYpICYgMHhmZikvMHhmZjtcclxuXHRcdHRoaXMuX2NvbG9yRyA9ICgodGhpcy5fY29sb3IgPj4gOCkgJiAweGZmKS8weGZmO1xyXG5cdFx0dGhpcy5fY29sb3JCID0gKHRoaXMuX2NvbG9yICYgMHhmZikvMHhmZjtcclxuXHJcblx0XHR0aGlzLnVwZGF0ZURpZmZ1c2UoKTtcclxuXHRcdHRoaXMudXBkYXRlU3BlY3VsYXIoKTtcclxuXHR9XHJcblxyXG5cdHB1YmxpYyBnZXQgYW1iaWVudCgpOm51bWJlclxyXG5cdHtcclxuXHRcdHJldHVybiB0aGlzLl9hbWJpZW50O1xyXG5cdH1cclxuXHJcblx0cHVibGljIHNldCBhbWJpZW50KHZhbHVlOm51bWJlcilcclxuXHR7XHJcblx0XHRpZiAodmFsdWUgPCAwKVxyXG5cdFx0XHR2YWx1ZSA9IDA7XHJcblx0XHRlbHNlIGlmICh2YWx1ZSA+IDEpXHJcblx0XHRcdHZhbHVlID0gMTtcclxuXHJcblx0XHR0aGlzLl9hbWJpZW50ID0gdmFsdWU7XHJcblx0XHR0aGlzLnVwZGF0ZUFtYmllbnQoKTtcclxuXHR9XHJcblxyXG5cdHB1YmxpYyBnZXQgYW1iaWVudENvbG9yKCk6bnVtYmVyXHJcblx0e1xyXG5cdFx0cmV0dXJuIHRoaXMuX2FtYmllbnRDb2xvcjtcclxuXHR9XHJcblxyXG5cdHB1YmxpYyBzZXQgYW1iaWVudENvbG9yKHZhbHVlOm51bWJlcilcclxuXHR7XHJcblx0XHR0aGlzLl9hbWJpZW50Q29sb3IgPSB2YWx1ZTtcclxuXHRcdHRoaXMudXBkYXRlQW1iaWVudCgpO1xyXG5cdH1cclxuXHJcblx0cHJpdmF0ZSB1cGRhdGVBbWJpZW50KClcclxuXHR7XHJcblx0XHR0aGlzLl9pQW1iaWVudFIgPSAoKHRoaXMuX2FtYmllbnRDb2xvciA+PiAxNikgJiAweGZmKS8weGZmKnRoaXMuX2FtYmllbnQ7XHJcblx0XHR0aGlzLl9pQW1iaWVudEcgPSAoKHRoaXMuX2FtYmllbnRDb2xvciA+PiA4KSAmIDB4ZmYpLzB4ZmYqdGhpcy5fYW1iaWVudDtcclxuXHRcdHRoaXMuX2lBbWJpZW50QiA9ICh0aGlzLl9hbWJpZW50Q29sb3IgJiAweGZmKS8weGZmKnRoaXMuX2FtYmllbnQ7XHJcblx0fVxyXG5cclxuXHRwdWJsaWMgaUdldE9iamVjdFByb2plY3Rpb25NYXRyaXgoZW50aXR5OklFbnRpdHksIGNhbWVyYTpDYW1lcmEsIHRhcmdldDpNYXRyaXgzRCA9IG51bGwpOk1hdHJpeDNEXHJcblx0e1xyXG5cdFx0dGhyb3cgbmV3IEFic3RyYWN0TWV0aG9kRXJyb3IoKTtcclxuXHR9XHJcblxyXG5cdC8vQG92ZXJyaWRlXHJcblx0cHVibGljIGdldCBhc3NldFR5cGUoKTpzdHJpbmdcclxuXHR7XHJcblx0XHRyZXR1cm4gQXNzZXRUeXBlLkxJR0hUO1xyXG5cdH1cclxuXHJcblx0cHJpdmF0ZSB1cGRhdGVTcGVjdWxhcigpXHJcblx0e1xyXG5cdFx0dGhpcy5faVNwZWN1bGFyUiA9IHRoaXMuX2NvbG9yUip0aGlzLl9zcGVjdWxhcjtcclxuXHRcdHRoaXMuX2lTcGVjdWxhckcgPSB0aGlzLl9jb2xvckcqdGhpcy5fc3BlY3VsYXI7XHJcblx0XHR0aGlzLl9pU3BlY3VsYXJCID0gdGhpcy5fY29sb3JCKnRoaXMuX3NwZWN1bGFyO1xyXG5cdH1cclxuXHJcblx0cHJpdmF0ZSB1cGRhdGVEaWZmdXNlKClcclxuXHR7XHJcblx0XHR0aGlzLl9pRGlmZnVzZVIgPSB0aGlzLl9jb2xvclIqdGhpcy5fZGlmZnVzZTtcclxuXHRcdHRoaXMuX2lEaWZmdXNlRyA9IHRoaXMuX2NvbG9yRyp0aGlzLl9kaWZmdXNlO1xyXG5cdFx0dGhpcy5faURpZmZ1c2VCID0gdGhpcy5fY29sb3JCKnRoaXMuX2RpZmZ1c2U7XHJcblx0fVxyXG5cclxuXHRwdWJsaWMgZ2V0IHNoYWRvd01hcHBlcigpOlNoYWRvd01hcHBlckJhc2VcclxuXHR7XHJcblx0XHRyZXR1cm4gdGhpcy5fc2hhZG93TWFwcGVyO1xyXG5cdH1cclxuXHJcblx0cHVibGljIHNldCBzaGFkb3dNYXBwZXIodmFsdWU6U2hhZG93TWFwcGVyQmFzZSlcclxuXHR7XHJcblx0XHR0aGlzLl9zaGFkb3dNYXBwZXIgPSB2YWx1ZTtcclxuXHRcdHRoaXMuX3NoYWRvd01hcHBlci5saWdodCA9IHRoaXM7XHJcblx0fVxyXG59XHJcblxyXG5leHBvcnQgPSBMaWdodEJhc2U7Il19