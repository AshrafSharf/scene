/**
 * TimelineFrame holds 3 list of FrameCommands
 *  - list1 _frameCommands should be  executed when playing the timeline (previous Frame was played)
 *  - list2 _frameCommandsReverse should be executed when playing the timeline reversed (previous Frame was played)
 *  - list3 _frameCommandsInit should be executed when jumping to a frame, so we need to fully init the frame
 *
 *  Addionial TimelineFrame properties are:
 *  - script - can be executed, after the frameCommands have been executed
 *  - list of FrameLabels, and list of corresponding labelTypes
 *  - duration-value (1 frame is not necessary 1 frame long)
 *  - startTime and endTime are needed internally when deciding what frame to display
 */
var TimeLineFrame = (function () {
    function TimeLineFrame() {
        this._isDirty = true;
        this._script = "";
        this._duration = 1; //use millisecs for duration ? or frames ?
        this._frameCommands = new Array();
        this._frameCommandsReverse = new Array();
        this._frameCommandsInit = new Array();
        this._framelabels = new Array();
        this._labelTypes = new Array();
    }
    TimeLineFrame.prototype.addCommand = function (newCommand) {
        // make the timeline available for the commands
        this._frameCommands.push(newCommand);
    };
    TimeLineFrame.prototype.addCommandReverse = function (newCommand) {
        // make the timeline available for the commands
        this._frameCommandsReverse.push(newCommand);
    };
    TimeLineFrame.prototype.addCommandInit = function (newCommand) {
        // make the timeline available for the commands
        this._frameCommandsInit.push(newCommand);
    };
    TimeLineFrame.prototype.addLabel = function (label, type) {
        this._framelabels.push(label);
        this._labelTypes.push(type);
    };
    Object.defineProperty(TimeLineFrame.prototype, "framelabels", {
        get: function () {
            return this._framelabels;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(TimeLineFrame.prototype, "labelTypes", {
        get: function () {
            return this._labelTypes;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(TimeLineFrame.prototype, "script", {
        get: function () {
            return this._script;
        },
        enumerable: true,
        configurable: true
    });
    TimeLineFrame.prototype.addToScript = function (newscript) {
        this._script += newscript;
    };
    Object.defineProperty(TimeLineFrame.prototype, "isDirty", {
        get: function () {
            return this._isDirty;
        },
        enumerable: true,
        configurable: true
    });
    TimeLineFrame.prototype.makeDirty = function () {
        this._isDirty = true;
    };
    Object.defineProperty(TimeLineFrame.prototype, "startTime", {
        get: function () {
            return this._startTime;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(TimeLineFrame.prototype, "duration", {
        get: function () {
            return this._duration;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(TimeLineFrame.prototype, "endTime", {
        get: function () {
            return this._endTime;
        },
        enumerable: true,
        configurable: true
    });
    TimeLineFrame.prototype.setFrameTime = function (startTime, duration) {
        this._startTime = startTime;
        this._duration = duration;
        this._endTime = startTime + duration;
    };
    /**
     * executes the set of Commands for this Frame.
     * Each Frame has 3 sets of commands:
     *  0 = init frame commands = the frame must be init as if previous frame was not played
     *  1 = play frame commands = the previous frame was played
     *  2 = playReverse Commands = the next frame was played
     */
    TimeLineFrame.prototype.executeCommands = function (commandSet, time, speed) {
        // execute all the  frame commands for this frame
        if (commandSet == 0) {
            for (var i = 0; i < this._frameCommandsInit.length; i++) {
                this._frameCommandsInit[i].execute(time, speed);
            }
        }
        else if (commandSet == 1) {
            for (var i = 0; i < this._frameCommands.length; i++) {
                this._frameCommands[i].execute(time, speed);
            }
        }
        else if (commandSet == 2) {
            for (var i = 0; i < this._frameCommandsReverse.length; i++) {
                this._frameCommandsReverse[i].execute(time, speed);
            }
        }
        // mark this frame as not dirty, so it will not get executed again, unless TimeLine makes it dirty again.
        // whenever a Frame is entered, the Timeline should mark the previous frame as dirty.
        this._isDirty = false;
    };
    return TimeLineFrame;
})();
module.exports = TimeLineFrame;

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImF3YXlqcy1kaXNwbGF5L2xpYi9lbnRpdGllcy90aW1lbGluZWRhdGEvdGltZWxpbmVmcmFtZS50cyJdLCJuYW1lcyI6WyJUaW1lTGluZUZyYW1lIiwiVGltZUxpbmVGcmFtZS5jb25zdHJ1Y3RvciIsIlRpbWVMaW5lRnJhbWUuYWRkQ29tbWFuZCIsIlRpbWVMaW5lRnJhbWUuYWRkQ29tbWFuZFJldmVyc2UiLCJUaW1lTGluZUZyYW1lLmFkZENvbW1hbmRJbml0IiwiVGltZUxpbmVGcmFtZS5hZGRMYWJlbCIsIlRpbWVMaW5lRnJhbWUuZnJhbWVsYWJlbHMiLCJUaW1lTGluZUZyYW1lLmxhYmVsVHlwZXMiLCJUaW1lTGluZUZyYW1lLnNjcmlwdCIsIlRpbWVMaW5lRnJhbWUuYWRkVG9TY3JpcHQiLCJUaW1lTGluZUZyYW1lLmlzRGlydHkiLCJUaW1lTGluZUZyYW1lLm1ha2VEaXJ0eSIsIlRpbWVMaW5lRnJhbWUuc3RhcnRUaW1lIiwiVGltZUxpbmVGcmFtZS5kdXJhdGlvbiIsIlRpbWVMaW5lRnJhbWUuZW5kVGltZSIsIlRpbWVMaW5lRnJhbWUuc2V0RnJhbWVUaW1lIiwiVGltZUxpbmVGcmFtZS5leGVjdXRlQ29tbWFuZHMiXSwibWFwcGluZ3MiOiJBQXFCQSxBQVlBOzs7Ozs7Ozs7OztHQURHO0lBQ0csYUFBYTtJQWNmQSxTQWRFQSxhQUFhQTtRQWdCWEMsSUFBSUEsQ0FBQ0EsUUFBUUEsR0FBQ0EsSUFBSUEsQ0FBQ0E7UUFDbkJBLElBQUlBLENBQUNBLE9BQU9BLEdBQUNBLEVBQUVBLENBQUNBO1FBQ2hCQSxJQUFJQSxDQUFDQSxTQUFTQSxHQUFDQSxDQUFDQSxFQUFDQSwwQ0FBMENBO1FBQzNEQSxJQUFJQSxDQUFDQSxjQUFjQSxHQUFDQSxJQUFJQSxLQUFLQSxFQUFnQkEsQ0FBQ0E7UUFDOUNBLElBQUlBLENBQUNBLHFCQUFxQkEsR0FBQ0EsSUFBSUEsS0FBS0EsRUFBZ0JBLENBQUNBO1FBQ3JEQSxJQUFJQSxDQUFDQSxrQkFBa0JBLEdBQUNBLElB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QUNBLE9BQU9BLENBQUNBLElBQUlBLEVBQUVBLEtBQUtBLENBQUNBLENBQUNBO1lBQ3ZEQSxDQUFDQTtRQUNMQSxDQUFDQTtRQUNEQSxBQUVBQSx5R0FGeUdBO1FBQ3pHQSxxRkFBcUZBO1FBQ3JGQSxJQUFJQSxDQUFDQSxRQUFRQSxHQUFDQSxLQUFLQSxDQUFDQTtJQUN4QkEsQ0FBQ0E7SUFFTGhCLG9CQUFDQTtBQUFEQSxDQXZIQSxBQXVIQ0EsSUFBQTtBQUVELEFBQXVCLGlCQUFkLGFBQWEsQ0FBQyIsImZpbGUiOiJlbnRpdGllcy90aW1lbGluZWRhdGEvVGltZUxpbmVGcmFtZS5qcyIsInNvdXJjZVJvb3QiOiIuLi8iLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgQXNzZXRUeXBlXHRcdFx0XHRcdD0gcmVxdWlyZShcImF3YXlqcy1jb3JlL2xpYi9saWJyYXJ5L0Fzc2V0VHlwZVwiKTtcclxuaW1wb3J0IElBc3NldFx0XHRcdFx0XHQgICAgPSByZXF1aXJlKFwiYXdheWpzLWNvcmUvbGliL2xpYnJhcnkvSUFzc2V0XCIpO1xyXG5pbXBvcnQgTWF0cml4M0RcdFx0XHRcdFx0ICAgID0gcmVxdWlyZShcImF3YXlqcy1jb3JlL2xpYi9nZW9tL01hdHJpeDNEXCIpO1xyXG5pbXBvcnQgTWF0cml4XHRcdFx0XHRcdCAgICA9IHJlcXVpcmUoXCJhd2F5anMtY29yZS9saWIvZ2VvbS9NYXRyaXhcIik7XHJcblxyXG5pbXBvcnQgSUFuaW1hdG9yXHRcdFx0XHRcdD0gcmVxdWlyZShcImF3YXlqcy1kaXNwbGF5L2xpYi9hbmltYXRvcnMvSUFuaW1hdG9yXCIpO1xyXG5pbXBvcnQgU3ViR2VvbWV0cnlCYXNlXHRcdFx0XHQ9IHJlcXVpcmUoXCJhd2F5anMtZGlzcGxheS9saWIvYmFzZS9TdWJHZW9tZXRyeUJhc2VcIik7XHJcbmltcG9ydCBTdWJHZW9tZXRyeVx0XHRcdFx0XHQ9IHJlcXVpcmUoXCJhd2F5anMtZGlzcGxheS9saWIvYmFzZS9UcmlhbmdsZVN1Ykdlb21ldHJ5XCIpO1xyXG5pbXBvcnQgSVN1Yk1lc2hcdFx0XHRcdFx0XHQ9IHJlcXVpcmUoXCJhd2F5anMtZGlzcGxheS9saWIvYmFzZS9JU3ViTWVzaFwiKTtcclxuaW1wb3J0IElTdWJNZXNoQ2xhc3NcdFx0XHRcdD0gcmVxdWlyZShcImF3YXlqcy1kaXNwbGF5L2xpYi9iYXNlL0lTdWJNZXNoQ2xhc3NcIik7XHJcbmltcG9ydCBHZW9tZXRyeVx0XHRcdFx0XHRcdD0gcmVxdWlyZShcImF3YXlqcy1kaXNwbGF5L2xpYi9iYXNlL0dlb21ldHJ5XCIpO1xyXG5pbXBvcnQgR2VvbWV0cnlFdmVudFx0XHRcdFx0PSByZXF1aXJlKFwiYXdheWpzLWRpc3BsYXkvbGliL2V2ZW50cy9HZW9tZXRyeUV2ZW50XCIpO1xyXG5pbXBvcnQgTWF0ZXJpYWxCYXNlXHRcdFx0XHRcdD0gcmVxdWlyZShcImF3YXlqcy1kaXNwbGF5L2xpYi9tYXRlcmlhbHMvTWF0ZXJpYWxCYXNlXCIpO1xyXG5pbXBvcnQgRW50aXR5Tm9kZVx0XHRcdFx0XHQ9IHJlcXVpcmUoXCJhd2F5anMtZGlzcGxheS9saWIvcGFydGl0aW9uL0VudGl0eU5vZGVcIik7XHJcbmltcG9ydCBJUmVuZGVyZXJcdFx0XHRcdFx0PSByZXF1aXJlKFwiYXdheWpzLWRpc3BsYXkvbGliL3JlbmRlci9JUmVuZGVyZXJcIik7XHJcbmltcG9ydCBEaXNwbGF5T2JqZWN0Q29udGFpbmVyXHRcdCA9IHJlcXVpcmUoXCJhd2F5anMtZGlzcGxheS9saWIvY29udGFpbmVycy9EaXNwbGF5T2JqZWN0Q29udGFpbmVyXCIpO1xyXG5pbXBvcnQgTWVzaFx0XHQgICAgICAgICAgICAgICAgICAgID0gcmVxdWlyZShcImF3YXlqcy1kaXNwbGF5L2xpYi9lbnRpdGllcy9NZXNoXCIpO1xyXG5pbXBvcnQgVGltZUxpbmUgPSByZXF1aXJlKFwiYXdheWpzLWRpc3BsYXkvbGliL2VudGl0aWVzL1RpbWVMaW5lXCIpO1xyXG5pbXBvcnQgRnJhbWVDb21tYW5kID0gcmVxdWlyZShcImF3YXlqcy1kaXNwbGF5L2xpYi9lbnRpdGllcy90aW1lbGluZWRhdGEvRnJhbWVDb21tYW5kXCIpO1xyXG5cclxuXHJcbi8qKlxyXG4gKiBUaW1lbGluZUZyYW1lIGhvbGRzIDMgbGlzdCBvZiBGcmFtZUNvbW1hbmRzXHJcbiAqICAtIGxpc3QxIF9mcmFtZUNvbW1hbmRzIHNob3VsZCBiZSAgZXhlY3V0ZWQgd2hlbiBwbGF5aW5nIHRoZSB0aW1lbGluZSAocHJldmlvdXMgRnJhbWUgd2FzIHBsYXllZClcclxuICogIC0gbGlzdDIgX2ZyYW1lQ29tbWFuZHNSZXZlcnNlIHNob3VsZCBiZSBleGVjdXRlZCB3aGVuIHBsYXlpbmcgdGhlIHRpbWVsaW5lIHJldmVyc2VkIChwcmV2aW91cyBGcmFtZSB3YXMgcGxheWVkKVxyXG4gKiAgLSBsaXN0MyBfZnJhbWVDb21tYW5kc0luaXQgc2hvdWxkIGJlIGV4ZWN1dGVkIHdoZW4ganVtcGluZyB0byBhIGZyYW1lLCBzbyB3ZSBuZWVkIHRvIGZ1bGx5IGluaXQgdGhlIGZyYW1lXHJcbiAqXHJcbiAqICBBZGRpb25pYWwgVGltZWxpbmVGcmFtZSBwcm9wZXJ0aWVzIGFyZTpcclxuICogIC0gc2NyaXB0IC0gY2FuIGJlIGV4ZWN1dGVkLCBhZnRlciB0aGUgZnJhbWVDb21tYW5kcyBoYXZlIGJlZW4gZXhlY3V0ZWRcclxuICogIC0gbGlzdCBvZiBGcmFtZUxhYmVscywgYW5kIGxpc3Qgb2YgY29ycmVzcG9uZGluZyBsYWJlbFR5cGVzXHJcbiAqICAtIGR1cmF0aW9uLXZhbHVlICgxIGZyYW1lIGlzIG5vdCBuZWNlc3NhcnkgMSBmcmFtZSBsb25nKVxyXG4gKiAgLSBzdGFydFRpbWUgYW5kIGVuZFRpbWUgYXJlIG5lZWRlZCBpbnRlcm5hbGx5IHdoZW4gZGVjaWRpbmcgd2hhdCBmcmFtZSB0byBkaXNwbGF5XHJcbiAqL1xyXG5jbGFzcyBUaW1lTGluZUZyYW1lXHJcbntcclxuICAgIHByaXZhdGUgX3NjcmlwdDpzdHJpbmc7XHJcbiAgICBwcml2YXRlIF9zdGFydFRpbWU6bnVtYmVyO1xyXG4gICAgcHJpdmF0ZSBfZW5kVGltZTpudW1iZXI7XHJcbiAgICBwcml2YXRlIF9kdXJhdGlvbjpudW1iZXI7XHJcbiAgICBwcml2YXRlIF90aW1lbGluZTpUaW1lTGluZTtcclxuICAgIHByaXZhdGUgX2ZyYW1lQ29tbWFuZHM6QXJyYXk8RnJhbWVDb21tYW5kPjtcclxuICAgIHByaXZhdGUgX2ZyYW1lQ29tbWFuZHNSZXZlcnNlOkFycmF5PEZyYW1lQ29tbWFuZD47XHJcbiAgICBwcml2YXRlIF9mcmFtZUNvbW1hbmRzSW5pdDpBcnJheTxGcmFtZUNvbW1hbmQ+O1xyXG4gICAgcHJpdmF0ZSBfZnJhbWVsYWJlbHM6QXJyYXk8c3RyaW5nPjtcclxuICAgIHByaXZhdGUgX2xhYmVsVHlwZXM6QXJyYXk8bnVtYmVyPjtcclxuICAgIHByaXZhdGUgX2lzRGlydHk6Ym9vbGVhbjtcclxuXHJcbiAgICBjb25zdHJ1Y3RvcigpXHJcbiAgICB7XHJcbiAgICAgICAgdGhpcy5faXNEaXJ0eT10cnVlO1xyXG4gICAgICAgIHRoaXMuX3NjcmlwdD1cIlwiO1xyXG4gICAgICAgIHRoaXMuX2R1cmF0aW9uPTE7Ly91c2UgbWlsbGlzZWNzIGZvciBkdXJhdGlvbiA/IG9yIGZyYW1lcyA/XHJcbiAgICAgICAgdGhpcy5fZnJhbWVDb21tYW5kcz1uZXcgQXJyYXk8RnJhbWVDb21tYW5kPigpO1xyXG4gICAgICAgIHRoaXMuX2ZyYW1lQ29tbWFuZHNSZXZlcnNlPW5ldyBBcnJheTxGcmFtZUNvbW1hbmQ+KCk7XHJcbiAgICAgICAgdGhpcy5fZnJhbWVDb21tYW5kc0luaXQ9bmV3IEFycmF5PEZyYW1lQ29tbWFuZD4oKTtcclxuICAgICAgICB0aGlzLl9mcmFtZWxhYmVscz1uZXcgQXJyYXk8c3RyaW5nPigpO1xyXG4gICAgICAgIHRoaXMuX2xhYmVsVHlwZXM9bmV3IEFycmF5PG51bWJlcj4oKTtcclxuICAgIH1cclxuICAgIHB1YmxpYyBhZGRDb21tYW5kKG5ld0NvbW1hbmQ6RnJhbWVDb21tYW5kKVxyXG4gICAge1xyXG4gICAgICAgIC8vIG1ha2UgdGhlIHRpbWVsaW5lIGF2YWlsYWJsZSBmb3IgdGhlIGNvbW1hbmRzXHJcbiAgICAgICAgdGhpcy5fZnJhbWVDb21tYW5kcy5wdXNoKG5ld0NvbW1hbmQpO1xyXG4gICAgfVxyXG4gICAgcHVibGljIGFkZENvbW1hbmRSZXZlcnNlKG5ld0NvbW1hbmQ6RnJhbWVDb21tYW5kKVxyXG4gICAge1xyXG4gICAgICAgIC8vIG1ha2UgdGhlIHRpbWVsaW5lIGF2YWlsYWJsZSBmb3IgdGhlIGNvbW1hbmRzXHJcbiAgICAgICAgdGhpcy5fZnJhbWVDb21tYW5kc1JldmVyc2UucHVzaChuZXdDb21tYW5kKTtcclxuICAgIH1cclxuICAgIHB1YmxpYyBhZGRDb21tYW5kSW5pdChuZXdDb21tYW5kOkZyYW1lQ29tbWFuZClcclxuICAgIHtcclxuICAgICAgICAvLyBtYWtlIHRoZSB0aW1lbGluZSBhdmFpbGFibGUgZm9yIHRoZSBjb21tYW5kc1xyXG4gICAgICAgIHRoaXMuX2ZyYW1lQ29tbWFuZHNJbml0LnB1c2gobmV3Q29tbWFuZCk7XHJcbiAgICB9XHJcbiAgICBwdWJsaWMgYWRkTGFiZWwobGFiZWw6c3RyaW5nLCB0eXBlOm51bWJlcilcclxuICAgIHtcclxuICAgICAgICB0aGlzLl9mcmFtZWxhYmVscy5wdXNoKGxhYmVsKTtcclxuICAgICAgICB0aGlzLl9sYWJlbFR5cGVzLnB1c2godHlwZSk7XHJcbiAgICB9XHJcbiAgICBwdWJsaWMgZ2V0IGZyYW1lbGFiZWxzKCk6QXJyYXk8c3RyaW5nPlxyXG4gICAge1xyXG4gICAgICAgIHJldHVybiB0aGlzLl9mcmFtZWxhYmVscztcclxuICAgIH1cclxuICAgIHB1YmxpYyBnZXQgbGFiZWxUeXBlcygpOkFycmF5PG51bWJlcj5cclxuICAgIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5fbGFiZWxUeXBlcztcclxuICAgIH1cclxuICAgIHB1YmxpYyBnZXQgc2NyaXB0KCk6c3RyaW5nXHJcbiAgICB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX3NjcmlwdDtcclxuICAgIH1cclxuICAgIHB1YmxpYyBhZGRUb1NjcmlwdChuZXdzY3JpcHQ6c3RyaW5nKVxyXG4gICAge1xyXG4gICAgICAgIHRoaXMuX3NjcmlwdCs9bmV3c2NyaXB0O1xyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBnZXQgaXNEaXJ0eSgpOmJvb2xlYW5cclxuICAgIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5faXNEaXJ0eTtcclxuICAgIH1cclxuICAgIHB1YmxpYyBtYWtlRGlydHkoKTp2b2lkXHJcbiAgICB7XHJcbiAgICAgICAgdGhpcy5faXNEaXJ0eT10cnVlO1xyXG4gICAgfVxyXG4gICAgcHVibGljIGdldCBzdGFydFRpbWUoKTpudW1iZXJcclxuICAgIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5fc3RhcnRUaW1lO1xyXG4gICAgfVxyXG4gICAgcHVibGljIGdldCBkdXJhdGlvbigpOm51bWJlclxyXG4gICAge1xyXG4gICAgICAgIHJldHVybiB0aGlzLl9kdXJhdGlvbjtcclxuICAgIH1cclxuICAgIHB1YmxpYyBnZXQgZW5kVGltZSgpOm51bWJlclxyXG4gICAge1xyXG4gICAgICAgIHJldHVybiB0aGlzLl9lbmRUaW1lO1xyXG4gICAgfVxyXG4gICAgcHVibGljIHNldEZyYW1lVGltZShzdGFydFRpbWU6bnVtYmVyLCBkdXJhdGlvbjpudW1iZXIpXHJcbiAgICB7XHJcbiAgICAgICAgdGhpcy5fc3RhcnRUaW1lPXN0YXJ0VGltZTtcclxuICAgICAgICB0aGlzLl9kdXJhdGlvbj1kdXJhdGlvbjtcclxuICAgICAgICB0aGlzLl9lbmRUaW1lPXN0YXJ0VGltZStkdXJhdGlvbjtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogZXhlY3V0ZXMgdGhlIHNldCBvZiBDb21tYW5kcyBmb3IgdGhpcyBGcmFtZS5cclxuICAgICAqIEVhY2ggRnJhbWUgaGFzIDMgc2V0cyBvZiBjb21tYW5kczpcclxuICAgICAqICAwID0gaW5pdCBmcmFtZSBjb21tYW5kcyA9IHRoZSBmcmFtZSBtdXN0IGJlIGluaXQgYXMgaWYgcHJldmlvdXMgZnJhbWUgd2FzIG5vdCBwbGF5ZWRcclxuICAgICAqICAxID0gcGxheSBmcmFtZSBjb21tYW5kcyA9IHRoZSBwcmV2aW91cyBmcmFtZSB3YXMgcGxheWVkXHJcbiAgICAgKiAgMiA9IHBsYXlSZXZlcnNlIENvbW1hbmRzID0gdGhlIG5leHQgZnJhbWUgd2FzIHBsYXllZFxyXG4gICAgICovXHJcbiAgICBwdWJsaWMgZXhlY3V0ZUNvbW1hbmRzKGNvbW1hbmRTZXQ6bnVtYmVyLCB0aW1lOm51bWJlciwgc3BlZWQ6bnVtYmVyKXtcclxuICAgICAgICAvLyBleGVjdXRlIGFsbCB0aGUgIGZyYW1lIGNvbW1hbmRzIGZvciB0aGlzIGZyYW1lXHJcbiAgICAgICAgaWYoY29tbWFuZFNldD09MCl7XHJcbiAgICAgICAgICAgIC8vdG9kbzogY3JlYXRlIHRoZSBmcmFtZUNvbW1hbmRzIGZvciBpbml0IGluIHRoZSBwYXJzZXJcclxuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLl9mcmFtZUNvbW1hbmRzSW5pdC5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fZnJhbWVDb21tYW5kc0luaXRbaV0uZXhlY3V0ZSh0aW1lLCBzcGVlZCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAoY29tbWFuZFNldD09MSkge1xyXG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMuX2ZyYW1lQ29tbWFuZHMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuX2ZyYW1lQ29tbWFuZHNbaV0uZXhlY3V0ZSh0aW1lLCBzcGVlZCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAoY29tbWFuZFNldD09Mikge1xyXG4gICAgICAgICAgICAvL3RvZG86IGNyZWF0ZSB0aGUgZnJhbWVDb21tYW5kcyBmb3IgcmV2ZXJzZSBwbGF5YmFjayBpbiB0aGUgcGFyc2VyXHJcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5fZnJhbWVDb21tYW5kc1JldmVyc2UubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuX2ZyYW1lQ29tbWFuZHNSZXZlcnNlW2ldLmV4ZWN1dGUodGltZSwgc3BlZWQpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIG1hcmsgdGhpcyBmcmFtZSBhcyBub3QgZGlydHksIHNvIGl0IHdpbGwgbm90IGdldCBleGVjdXRlZCBhZ2FpbiwgdW5sZXNzIFRpbWVMaW5lIG1ha2VzIGl0IGRpcnR5IGFnYWluLlxyXG4gICAgICAgIC8vIHdoZW5ldmVyIGEgRnJhbWUgaXMgZW50ZXJlZCwgdGhlIFRpbWVsaW5lIHNob3VsZCBtYXJrIHRoZSBwcmV2aW91cyBmcmFtZSBhcyBkaXJ0eS5cclxuICAgICAgICB0aGlzLl9pc0RpcnR5PWZhbHNlO1xyXG4gICAgfVxyXG5cclxufVxyXG5cclxuZXhwb3J0ID0gVGltZUxpbmVGcmFtZTtcclxuIl19